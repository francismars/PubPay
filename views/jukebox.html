<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>PUBPAY Jukebox - Competitive Music Queue</title>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="PUBPAY Jukebox - Competitive YouTube music queue powered by Nostr zaps. Zap to request songs and compete for priority!">

    <link rel="apple-touch-icon" sizes="57x57" href="images/icon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="images/icon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/icon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="images/icon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/icon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="images/icon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="images/icon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="images/icon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="images/icon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="images/icon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="images/icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="images/icon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/icon/favicon-16x16.png">
    <link rel="manifest" href="images/icon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="images/icon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="stylesheets/style.css?v0.06">
    <link rel="stylesheet" href="fonts/Inter-4.0/inter.css">

    <script src="./javascripts/qrious.min.js"></script>
    <script src="./javascripts/bolt11.min.js"></script>
    <script src="./javascripts/nostrtools.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
  </head>
  <body class="jukebox">

    <!-- Note Loader Container -->
    <div id="noteLoaderContainer">
      <div action="" id="noteLoader">
        <!-- App Header & Description -->
        <div class="app-header">
          <h1>üéµ PUBPAY Jukebox</h1>
          <p class="app-description">
            Competitive YouTube Music Queue powered by Nostr zaps
          </p>
          <div class="viral-features">
            <span class="feature-badge">üî• Zap to compete</span>
            <span class="feature-badge">üéØ Higher zaps = priority</span>
            <span class="feature-badge">‚ö° Lightning fast</span>
          </div>
        </div>
        
        <div class="note-input-section">
          <label for="note1LoaderInput">Enter a Nostr post ID to create your jukebox:</label><br>
          <input type="text" id="note1LoaderInput" name="note1LoaderInput" value="" placeholder="note16a..."><br>
          <button id="note1LoaderSubmit" class="button primary-button">üöÄ Launch Jukebox</button>
        </div>

        <div class="how-it-works">
          <h3>üéØ How it works</h3>
          <div class="steps">
            <div class="step">
              <div class="step-number">1</div>
              <div class="step-text">Load a Nostr post to create your jukebox</div>
            </div>
            <div class="step">
              <div class="step-number">2</div>
              <div class="step-text">People scan QR code and zap with song requests</div>
            </div>
            <div class="step">
              <div class="step-number">3</div>
              <div class="step-text">Higher zaps get priority in the queue</div>
            </div>
            <div class="step">
              <div class="step-number">4</div>
              <div class="step-text">Songs automatically play in priority order</div>
            </div>
          </div>
        </div>

        <div class="examples-section">
          <h3>üí° Examples</h3>
          <p>Just zap with a YouTube URL or song name in your comment:</p>
          <div class="example-comments">
            <div class="example-comment">"https://youtube.com/watch?v=dQw4w9WgXcQ"</div>
            <div class="example-comment">"Play Bohemian Rhapsody"</div>
            <div class="example-comment">"Rick Roll everyone!"</div>
          </div>
        </div>

        <div class="styleOptionsModalToggle button secondary-button">
          ‚öôÔ∏è Style Options
        </div>
      </div>
    </div>

         <!-- Main three-column layout -->
     <div id="mainLayout" class="main-layout jukebox-layout" style="display: none;">
      
      <!-- Background image overlay for the entire layout -->
      <div class="liveZapOverlay">
      </div>
      
      <!-- LEFT SIDE: Post/kind1 information and QR Code -->
      <div class="left-side">
        <div class="post-info">
          <h3 class="section-label">üéµ Jukebox Post</h3>
          
          <!-- Author Section -->
          <div class="author-section">
            <img id="authorNameProfileImg" class="author-image" src="/images/gradient_color.gif"/>
            <div class="author-info">
              <div id="authorName" class="author-name">Author</div>
            </div>
          </div>

          <!-- Note Content Section -->
          <div class="note-section">
            <div id="noteContent" class="note-content">
              <!-- Note content will be populated here -->
            </div>
          </div>

          <!-- QR Code Section -->
          <div class="qr-section">
            <a href="" target="_blank" id="qrcodeLinkNostr">
              <img id="qrCode" class="qr-code">
            </a>
            <div class="qr-instructions">
              üì± Scan to zap and request songs
            </div>
            <div class="qr-stats">
              <div class="stat-item">
                <span class="stat-label">Queue:</span>
                <span id="queueCount" class="stat-value">0</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Played:</span>
                <span id="playedCount" class="stat-value">0</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- CENTER: Currently Playing and Queue -->
      <div class="center-side">
        <!-- Currently Playing Section -->
        <div class="currently-playing">
          <h3 class="section-label">
            üéµ Now Playing
            <div class="zaps-header-right">
              <button id="styleToggleBtn" class="style-toggle-btn">
                ‚öôÔ∏è
              </button>
              
              <div class="powered-by">
                <img src="/images/powered_by_white_bg.png">
              </div>
            </div>
          </h3>
          <div id="currentVideo" class="video-container">
            <div class="no-video-message">
              <div class="no-video-icon">üéµ</div>
              <div class="no-video-text">No song playing yet</div>
              <div class="no-video-subtext">Zap to request the first song!</div>
            </div>
          </div>
          
          <!-- Video Progress Bar -->
          <div id="videoProgressContainer" class="video-progress-container" style="display: none;">
            <div class="progress-bar">
              <div id="videoProgressBar" class="progress-fill"></div>
            </div>
            <div class="progress-time">
              <span id="currentTime">0:00</span> / <span id="totalTime">0:00</span>
            </div>
          </div>
          <div id="currentSongInfo" class="song-info">
            <!-- Song info will be populated here -->
          </div>
          <div class="player-controls">
            <button id="skipSong" class="control-button skip-button" disabled>
              ‚è≠Ô∏è Skip Song
            </button>
          </div>
        </div>


      </div>

             <!-- RIGHT SIDE: Queue and History -->
       <div class="right-side">
        
        <!-- Queue Section (moved here) -->
        <div class="queue-section">
          <h3 class="section-label">üìã Next Up (Queue)</h3>
          <div id="queueStats" class="queue-stats">
            <span class="queue-count">0 songs in queue</span>
            <span class="queue-total">Total: 0 sats</span>
          </div>
          <div id="songQueue" class="song-queue">
            <!-- Queue will be populated here -->
          </div>
        </div>

        <!-- Played Songs History -->
        <div class="history-section">
          <h3 class="section-label">üìö Recently Played</h3>
          <div id="playedSongs" class="played-songs">
            <!-- Played songs will be populated here -->
          </div>
        </div>
      </div>
    </div>

    <!-- Style options modal -->
    <div id="styleOptionsModal">
      <div class="style-options-content">
        <div class="style-options-header">
          <h2>Style Options</h2>
          <button class="close-button">&times;</button>
        </div>
        <div class="style-options-body">
          <div class="style-option-group">
            <label for="textColorPicker">Text Color</label>
            <div class="color-picker-container">
              <input type="color" id="textColorPicker" value="#ffffff">
              <input type="text" id="textColorValue" value="#ffffff" placeholder="#ffffff">
            </div>
          </div>
          <div class="style-option-group">
            <label for="bgColorPicker">Background Color</label>
            <div class="color-picker-container">
              <input type="color" id="bgColorPicker" value="#000000">
              <input type="text" id="bgColorValue" value="#000000" placeholder="#000000">
            </div>
          </div>
          <div class="style-option-group full-width">
            <label for="bgImageUrl">Background Image URL</label>
            <div class="bg-image-controls">
              <div class="url-input-container">
                <input type="text" id="bgImageUrl" value="/images/lightning.gif" placeholder="Enter image URL">
                <br><button id="clearBgImage" class="clear-button">Clear</button>
              </div>
              <div class="preview-container">
                <img id="bgImagePreview" src="/images/lightning.gif" alt="Background preview">
              </div>
            </div>
          </div>
          <div class="style-option-group toggle-group">
            <label class="toggle-label">
              <div class="toggle-switch">
                <input type="checkbox" checked id="qrInvertToggle" value="true">
                <span class="toggle-slider"></span>
              </div>
              <span>Invert QR Code</span>
            </label>
          </div>
          <div class="style-option-group toggle-group">
            <label class="toggle-label">
              <div class="toggle-switch">
                <input type="checkbox" checked id="qrScreenBlendToggle" value="true">
                <span class="toggle-slider"></span>
              </div>
              <span>QR Code Screen Blend</span>
            </label>
          </div>
          <div class="style-option-group toggle-group">
            <label class="toggle-label">
              <div class="toggle-switch">
                <input type="checkbox" id="qrMultiplyBlendToggle">
                <span class="toggle-slider"></span>
              </div>
              <span>QR Code Multiply Blend</span>
            </label>
          </div>
          <div class="style-option-group toggle-group">
            <label class="toggle-label">
              <div class="toggle-switch">
                <input type="checkbox" id="layoutInvertToggle">
                <span class="toggle-slider"></span>
              </div>
              <span>Invert Layout</span>
            </label>
          </div>
          <div class="style-option-group toggle-group">
            <label class="toggle-label">
              <div class="toggle-switch">
                <input type="checkbox" id="hideZapperContentToggle">
                <span class="toggle-slider"></span>
              </div>
              <span>Hide Zapper Content</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Load jukebox.js after all other scripts -->
    <script type="module" src="./javascripts/jukebox.js"></script>
  </body>
</html>
