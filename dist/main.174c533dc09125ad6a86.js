(()=>{"use strict";var e,s={524:(e,s,n)=>{n.r(s),n.d(s,{useUIStore:()=>a});const a=(0,n(511).v)(e=>({invoiceOverlay:{show:!1,bolt11:"",amount:0,eventId:""},loginForm:{show:!1},newPayNoteForm:{show:!1},openInvoice:({bolt11:s,amount:n,eventId:a})=>e({invoiceOverlay:{show:!0,bolt11:s,amount:n,eventId:a}}),closeInvoice:()=>e({invoiceOverlay:{show:!1,bolt11:"",amount:0,eventId:""}}),openLogin:()=>e({loginForm:{show:!0}}),closeLogin:()=>e({loginForm:{show:!1}}),openNewPayNote:()=>e({newPayNoteForm:{show:!0}}),closeNewPayNote:()=>e({newPayNoteForm:{show:!1}})}))},802:(e,s,n)=>{var a=n(848),t=n(540),o=n(338),r=n(322),i=n(665),l=n(309);let c=null;const d=()=>(c||(c=new l.E),c);var p=n(524),m=n(661);const u=m.YOg(m.YjP()).refine(e=>e.length>=1,{message:"tag must have at least a key"}),h=m.Ikc({id:m.YjP().length(64),pubkey:m.YjP().length(64),kind:m.aig(),content:m.YjP(),created_at:m.aig().int(),tags:m.YOg(u),sig:m.YjP().optional()});function g(e,s){if(!e)return s;try{return JSON.parse(e)}catch{return s}}h.extend({kind:m.euz(0)}),h.extend({kind:m.euz(1)}),h.extend({kind:m.euz(9735)});const y=m.Ikc({pubkey:m.YjP().length(64).optional(),id:m.YjP().length(64).optional()});function f(e){if(!e)return null;try{const s=JSON.parse(e),n=y.safeParse(s);return n.success?n.data:null}catch{return null}}const b=["wss://relay.damus.io","wss://relay.primal.net","wss://nos.lol","wss://relay.snort.social","wss://relay.nostr.band"];class v{constructor(e=b){this.connections=new Map,this.subscriptions=new Map,this.inFlightRequests=new Map,this.relays=e,this.initializePool()}initializePool(){if("undefined"==typeof window||!window.NostrTools)throw new Error("NostrTools not available. Make sure nostrtools.min.js is loaded.");this.pool=new window.NostrTools.SimplePool}subscribeToEvents(e,s,n={}){const a=this.generateSubscriptionId(),t={id:a,filters:e,unsubscribe:()=>this.unsubscribe(a)};let o=null;return n.timeout&&(o=setTimeout(()=>{console.log(`Subscription ${a} timeout - keeping alive`)},n.timeout)),this.pool.subscribeMany(this.relays,e,{onevent:e=>{o&&clearTimeout(o),s(e)},oneose:()=>{o&&clearTimeout(o),n.oneose?.()},onclosed:()=>{o&&clearTimeout(o),n.onclosed?.()}}),this.subscriptions.set(a,t),t}subscribeToLiveEvents(e,s,n,a={}){const t={authors:[e],kinds:[30311],"#d":[s]};return this.subscribeToEvents([t],n,{timeout:a.timeout||3e4,onclosed:a.onclosed})}subscribeToZaps(e,s,n={}){const a={kinds:[9735],"#e":[e]};return this.subscribeToEvents([a],s,{timeout:n.timeout||3e4,onclosed:n.onclosed})}subscribeToLiveChat(e,s,n,a={}){const t={kinds:[1],"#a":[`30311:${e}:${s}`]};return this.subscribeToEvents([t],n,{timeout:a.timeout||3e4,onclosed:a.onclosed})}subscribeToProfiles(e,s,n={}){const a={authors:e,kinds:[0]};return this.subscribeToEvents([a],s,{timeout:n.timeout||3e4,onclosed:n.onclosed})}async publishEvent(e){try{await this.pool.publish(this.relays,e)}catch(e){const s=String(e?.message||e||"");if(s.includes("pow:")||s.toLowerCase().includes("proof-of-work"))return void console.warn("Publish encountered PoW requirement; treating as non-fatal");throw console.error("Failed to publish event:",e),new Error(`Failed to publish event: ${e}`)}}async getEvents(e){const s=JSON.stringify(e.map(e=>({kinds:e.kinds,authors:e.authors?[...new Set(e.authors)].sort():void 0,"#e":e["#e"]?[...new Set(e["#e"])].sort():void 0,"#t":e["#t"]?[...new Set(e["#t"])].sort():void 0,"#a":e["#a"]?[...new Set(e["#a"])].sort():void 0,limit:e.limit,until:e.until,since:e.since}))),n=this.inFlightRequests.get(s);if(n)return n;const a=new Promise((s,n)=>{try{if(!this.pool)throw new Error("Nostr pool not initialized");if(!this.relays||0===this.relays.length)throw new Error("No relays configured");if(!e||0===e.length)throw new Error("No filters provided");for(const s of e)if(!s.kinds||0===s.kinds.length)throw new Error("Invalid filter: missing kinds");console.log("Getting events with filters:",e),console.log("Filter structure:",JSON.stringify(e,null,2));const n=e.map(e=>JSON.parse(JSON.stringify(e)));console.log("Clean filters:",n);const a=[];let t=!1;const o=this.pool.subscribeMany(this.relays,n,{onevent(e){a.push(e)},oneose(){t||(t=!0,s(a))},onclosed(){t||(t=!0,console.log("Subscription closed, resolving with",a.length,"events"),s(a))}});setTimeout(()=>{t||(t=!0,o.close(),console.log("Timeout reached, resolving with",a.length,"events"),s(a))},1e4)}catch(e){console.error("Failed to get events:",e),n(new Error(`Failed to get events: ${e}`))}});return this.inFlightRequests.set(s,a),a.finally(()=>{this.inFlightRequests.get(s)===a&&this.inFlightRequests.delete(s)}),a}unsubscribe(e){this.subscriptions.get(e)&&this.subscriptions.delete(e)}unsubscribeAll(){this.subscriptions.forEach(e=>{e.unsubscribe()}),this.subscriptions.clear()}getRelayStatus(){return Array.from(this.connections.values())}addRelay(e){this.relays.includes(e)||this.relays.push(e)}removeRelay(e){this.relays=this.relays.filter(s=>s!==e)}getRelays(){return[...this.relays]}generateSubscriptionId(){return`sub_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}destroy(){if(this.unsubscribeAll(),this.pool&&"function"==typeof this.pool.close)try{this.pool.close()}catch(e){}}}const x=e=>["profile",e],N=async(e,s,n)=>{const a=(t=n,Array.from(new Set(t)).sort());var t;const o=new Map,r=[];for(const s of a){const n=e.getQueryData(x(s));n?o.set(s,n):r.push(s)}if(r.length>0){const n=await s.getEvents([{kinds:[0],authors:r}]);for(const s of n)e.setQueryData(x(s.pubkey),s,{updatedAt:Date.now()}),o.set(s.pubkey,s);const a=new Set(n.map(e=>e.pubkey));for(const s of r)a.has(s)||e.setQueryData(x(s),null,{updatedAt:Date.now()})}return o},w=e=>Array.from(new Set(e)).sort(),S=e=>["zaps",...w(e)],C=async(e,s,n)=>await e.ensureQueryData({queryKey:S(n),queryFn:()=>(async(e,s)=>{if(0===s.length)return[];const n=w(s);return await e.getEvents([{kinds:[9735],"#e":n}])})(s,n),staleTime:3e4}),j=e=>["posts",e.until??null,e.limit??21];class P{constructor(e){this.sessions=new Map,this.frontendSessionId=null,this.config=e,this.frontendSessionId=this.generateFrontendSessionId()}async enableLightningPayments(e){if(!this.config.enabled)return{success:!1,error:"Lightning payments are disabled"};if(!e)return{success:!1,error:"Event ID is required"};try{console.log("ðŸ”Œ LightningService: Request body:",{frontendSessionId:this.frontendSessionId,eventId:e});const s=await fetch("/lightning/enable",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({frontendSessionId:this.frontendSessionId,eventId:e})}),n=await s.json();if(n.success&&n.data){const s={sessionId:this.frontendSessionId,eventId:e,lnurlpId:n.data.lnurl,createdAt:Date.now(),expiresAt:Date.now()+864e5,status:"active"};return this.sessions.set(this.frontendSessionId,s),{success:!0,lnurl:n.data.lnurl,message:n.data.existing?"Lightning enabled (reusing existing link)":"Lightning enabled - scan QR to pay"}}return{success:!1,error:n.error||"Failed to enable Lightning payments"}}catch(e){return console.error("Error enabling Lightning payments:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async disableLightningPayments(e){if(!e)return{success:!1,error:"Event ID is required"};try{const s=await fetch("/lightning/disable",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({frontendSessionId:this.frontendSessionId,eventId:e})}),n=await s.json();return n.success?(this.frontendSessionId&&this.sessions.delete(this.frontendSessionId),{success:!0,message:n.data?.message||"Lightning payments disabled"}):{success:!1,error:n.error||"Failed to disable Lightning payments"}}catch(e){return console.error("Error disabling Lightning payments:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}getLightningStatus(){return{enabled:this.config.enabled,sessionId:this.frontendSessionId,activeSessions:this.sessions.size}}getActiveSessions(){const e=Date.now();return Array.from(this.sessions.values()).filter(s=>"active"===s.status&&s.expiresAt>e)}getSession(e){return this.sessions.get(e)||null}async createInvoice(e,s,n){if(!this.config.enabled)return{success:!1,error:"Lightning payments are disabled"};try{return{success:!0,invoice:{payment_hash:this.generatePaymentHash(),payment_request:`lnbc${e}u1p...`,description:s,amount_msat:1e3*e,amount_sat:e,created_at:Date.now(),expires_at:Date.now()+36e5,status:"pending"}}}catch(e){return console.error("Error creating Lightning invoice:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async checkPaymentStatus(e){try{return{success:!0,payment:{id:e,payment_hash:e,amount_msat:1e5,amount_sat:100,created_at:Date.now(),status:"completed",description:"Mock payment"}}}catch(e){return console.error("Error checking payment status:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}handleWebhook(e){try{const s=Array.from(this.sessions.values()).find(s=>s.eventId===e.description);return s?(s.status="active",{success:!0,message:"Webhook processed successfully"}):{success:!1,error:"No matching session found"}}catch(e){return console.error("Error handling webhook:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}generateLightningQR(e){return`lightning:${e}`}validateConfig(){const e=[];return this.config.lnbitsUrl||e.push("LNBits URL is required"),this.config.apiKey||e.push("LNBits API key is required"),this.config.webhookUrl||e.push("Webhook URL is required"),{valid:0===e.length,errors:e}}updateConfig(e){this.config={...this.config,...e}}getConfig(){return{...this.config}}cleanupExpiredSessions(){const e=Date.now();this.sessions.forEach((s,n)=>{s.expiresAt<e&&(s.status="expired",this.sessions.delete(n))})}generateFrontendSessionId(){return`frontend_${crypto.randomUUID()}`}generatePaymentHash(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}destroy(){this.sessions.clear(),this.frontendSessionId=null}}class _{static async signInWithExtension(){try{if(!window.nostr)return{success:!1,error:"Nostr extension not found. Please install a Nostr extension like Alby or nos2x."};const e=await window.nostr.getPublicKey();return e&&"string"==typeof e&&64===e.length?{success:!0,publicKey:e,method:"extension"}:{success:!1,error:"Invalid public key received from extension"}}catch(e){return console.error("Extension sign in failed:",e),{success:!1,error:e instanceof Error?e.message:"Extension sign in failed"}}}static async signInWithExternalSigner(e=!1){try{sessionStorage.setItem("signIn",JSON.stringify({rememberMe:e}));const s="nostrsigner:?compressionType=none&returnType=signature&type=get_public_key";return await new Promise(e=>{let n=!1;const a=()=>{"hidden"===document.visibilityState&&(n=!0,e(!0))};document.addEventListener("visibilitychange",a),window.location.href=s,setTimeout(()=>{document.removeEventListener("visibilitychange",a),e(!1)},3e3)})?{success:!0,method:"externalSigner"}:(sessionStorage.removeItem("signIn"),{success:!1,error:"Failed to launch 'nostrsigner': Redirection did not occur."})}catch(e){return console.error("External signer failed:",e),{success:!1,error:e instanceof Error?e.message:"External signer failed"}}}static async signInWithNsec(e){try{if(!window.NostrTools)return{success:!1,error:"NostrTools not available. Please ensure nostrtools.min.js is loaded."};if(!e||"string"!=typeof e)return{success:!1,error:"No nsec provided"};const{type:s,data:n}=window.NostrTools.nip19.decode(e);if("nsec"!==s)return{success:!1,error:"Invalid nsec format. Please provide a valid nsec string."};const a=window.NostrTools.getPublicKey(n);return a&&"string"==typeof a&&64===a.length?{success:!0,publicKey:a,privateKey:e,method:"nsec"}:{success:!1,error:"Failed to derive public key from nsec"}}catch(e){return console.error("Nsec sign in failed:",e),{success:!1,error:e instanceof Error?e.message:"Invalid nsec"}}}static async handleExternalSignerReturn(){try{if(void 0===JSON.parse(sessionStorage.getItem("signIn")||"{}").rememberMe){sessionStorage.removeItem("signIn");const e=await this.accessClipboard();if(!e)return{success:!1,error:"No public key found in clipboard"};const s=window.NostrTools.nip19.decode(e).data;return s&&"string"==typeof s&&64===s.length?{success:!0,publicKey:s,method:"externalSigner"}:{success:!1,error:"Invalid public key from clipboard"}}return{success:!1,error:"No external signer data found"}}catch(e){return console.error("External signer return failed:",e),{success:!1,error:e instanceof Error?e.message:"Failed to process external signer return"}}}static async accessClipboard(){try{if(navigator.clipboard&&navigator.clipboard.readText)return await navigator.clipboard.readText();{const e=document.createElement("textarea");e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();try{const s=document.execCommand("paste"),n=e.value;return document.body.removeChild(e),s?n:null}catch(s){return document.body.removeChild(e),null}}}catch(e){return console.error("Clipboard access failed:",e),null}}static storeAuthData(e,s,n,a){const t=a?localStorage:sessionStorage;t.setItem("publicKey",e),t.setItem("signInMethod",n),s&&t.setItem("privateKey",s)}static getStoredAuthData(){return{publicKey:localStorage.getItem("publicKey")||sessionStorage.getItem("publicKey"),privateKey:localStorage.getItem("privateKey")||sessionStorage.getItem("privateKey"),method:localStorage.getItem("signInMethod")||sessionStorage.getItem("signInMethod")}}static clearAuthData(){localStorage.removeItem("publicKey"),localStorage.removeItem("privateKey"),localStorage.removeItem("signInMethod"),sessionStorage.removeItem("publicKey"),sessionStorage.removeItem("privateKey"),sessionStorage.removeItem("signInMethod"),sessionStorage.removeItem("signIn")}static validateStoredAuthData(){const{publicKey:e,method:s}=this.getStoredAuthData();return e&&"string"==typeof e&&64===e.length&&!(!s||!this.METHODS.includes(s))||(this.clearAuthData(),!1)}static isAuthenticated(){return this.validateStoredAuthData()}static getCurrentUserPublicKey(){const{publicKey:e}=this.getStoredAuthData();return this.validateStoredAuthData()?e:null}static getCurrentUserPrivateKey(){const{privateKey:e}=this.getStoredAuthData();return this.validateStoredAuthData()?e:null}static getCurrentUserMethod(){const{method:e}=this.getStoredAuthData();return this.validateStoredAuthData()?e:null}}_.METHODS=["extension","externalSigner","nsec"];class E{constructor(e=""){this.baseUrl=e}async getInvoiceCallBack(e,s){try{console.log("getInvoiceCallBack called with:",{eventData:e,authorData:s});const n=e.tags.find(e=>"zap-lnurl"===e[0]);let a={};try{a=JSON.parse(s?.content||"{}")}catch{a={}}const t=n&&n.length>0?n[1]:a.lud16;if(!t)return console.error("No LUD16 address found for author"),null;const o=t.split("@");if(2!==o.length)return console.error("Invalid lud16 format"),null;let r,i=null;try{r=await fetch(`https://${o[1]}/.well-known/lnurlp/${o[0]}`)}catch{i="CAN'T PAY: Failed to fetch lud16"}if(r&&void 0!==r||(i="CAN'T PAY: Failed to fetch lud16"),i)return console.error(i),null;const l=await r.json();return!0!==l.allowsNostr&&(i="CAN'T PAY: No nostr support"),i?(console.error(i),null):{callbackToZap:l.callback,lud16ToZap:t}}catch(e){return console.error("Error getting invoice callback:",e),null}}async createZapEvent(e,s,n,a=null){try{const t=e.tags.find(e=>"zap-min"===e[0]),o=t?t[1]:1e3,r=-1!==s?1e3*parseInt(s.toString()):Math.floor(parseInt(o)),i=await window.NostrTools.nip57.makeZapRequest({event:e.id,profile:e.pubkey,amount:r,comment:"",relays:["wss://relay.damus.io","wss://relay.primal.net","wss://nostr.mutinywallet.com/","wss://relay.nostr.band/","wss://relay.nostr.nu/"]});if(console.log("Created zap event:",i),i.tags.push(["zap-lnurl",n]),i.tags.push(["t","pubpay"]),null!==a){i.pubkey=a;const e=window.NostrTools.getEventHash(i);null!==e&&(i.id=e)}return{zapEvent:i,amountPay:r}}catch(e){return console.error("Error creating zap event:",e),null}}async signZapEvent(e,s,n,a,t,o=!1){try{const r=window.signIn?.getSignInMethod();let i;if(!0===o){const s=window.NostrTools.generateSecretKey();i=window.NostrTools.finalizeEvent(e,s)}else{if("externalSigner"===r){const o=JSON.stringify(e);return sessionStorage.setItem("SignZapEvent",JSON.stringify({callback:s,amount:n,lud16:a,event:e,id:t})),window.location.href=`nostrsigner:${o}?compressionType=none&returnType=signature&type=sign_event`,!0}if("extension"===r)null!==window.nostr&&(i=await window.nostr.signEvent(e));else if("nsec"===r){const s=window.signIn?.getPrivateKey();if(!s)return console.error("No private key found. Please sign in first."),!1;const{data:n}=window.NostrTools.nip19.decode(s);i=window.NostrTools.finalizeEvent(e,n)}}return i?(await this.getInvoiceandPay(s,n,i,a,t),!0):(console.error("Failed to sign zap event - zapFinalized is undefined"),!1)}catch(e){return console.error("Error signing zap event:",e),!1}}async getInvoiceandPay(e,s,n,a,t){try{if(!n)return void console.error("Cannot get invoice - zapFinalized is undefined");const t=`${e}?amount=${s}&nostr=${JSON.stringify(n)}&lnurl=${a}`;console.log("Sending zap request to:",t);const o=await fetch(t);if(!o.ok){const e=await o.text();return void console.error("Failed to get invoice from callback:",o.status,e)}const r=await o.json();if(console.log("Lightning service response:",r),!r.pr)return void console.error("No invoice (pr) in response:",r);const{pr:i}=r;await this.handleFetchedInvoice(i,n.id)}catch(e){console.error("Error getting invoice and paying:",e)}}async handleFetchedInvoice(e,s){console.log("handleFetchedInvoice called with:",{invoice:`${e.substring(0,50)}...`,zapEventID:s});try{const{useUIStore:a}=await Promise.resolve().then(n.bind(n,524));a.getState().openInvoice({bolt11:e,amount:0,eventId:s})}catch(e){console.error("Failed to open invoice overlay via store:",e)}}}const I=()=>{const[e,s]=(0,t.useState)(!1),[a,o]=(0,t.useState)("global"),[r,i]=(0,t.useState)([]),[l,c]=(0,t.useState)([]),[p,m]=(0,t.useState)([]),[u,h]=(0,t.useState)(!1),[y,b]=(0,t.useState)({isLoggedIn:!1,publicKey:null,privateKey:null,signInMethod:null,userProfile:null,displayName:null}),x=(0,t.useRef)(null),w=(0,t.useRef)(null),S=(0,t.useRef)(null),I=(0,t.useRef)([]),A=(0,t.useRef)(!1),R=(0,t.useRef)(new Map),D=(0,t.useRef)(new Set),k=(0,t.useRef)([]),T=(0,t.useRef)(null);(0,t.useEffect)(()=>{if(x.current)return;const e=()=>{try{if("undefined"==typeof window||!window.NostrTools)return console.warn("NostrTools not available, retrying in 1 second..."),void setTimeout(e,1e3);x.current=new v;const s={enabled:!0,lnbitsUrl:"undefined"!=typeof process&&{ALLUSERSPROFILE:"C:\\ProgramData",ANDROID_HOME:"C:\\Users\\tantra\\AppData\\Local\\Android\\Sdk",APPDATA:"C:\\Users\\tantra\\AppData\\Roaming",CAMLIBS:"C:\\Program Files\\darktable\\lib\\libgphoto2\\2.5.31",CHROME_CRASHPAD_PIPE_NAME:"\\\\.\\pipe\\crashpad_21040_EGQPETFNPSMQWLBU",COLOR:"1",COLORTERM:"truecolor",CommonProgramFiles:"C:\\Program Files\\Common Files","CommonProgramFiles(x86)":"C:\\Program Files (x86)\\Common Files",CommonProgramW6432:"C:\\Program Files\\Common Files",COMPUTERNAME:"DESKTOP-4JB96TD",ComSpec:"C:\\Windows\\system32\\cmd.exe",CURSOR_TRACE_ID:"6feaa83eb99f452084eacea2d37d1776",DriverData:"C:\\Windows\\System32\\Drivers\\DriverData",EDITOR:"C:\\Windows\\notepad.exe",EFC_15356_1592913036:"1",EFC_15356_2283032206:"1",EFC_15356_2775293581:"1",EFC_15356_3789132940:"1",FPS_BROWSER_APP_PROFILE_STRING:"Internet Explorer",FPS_BROWSER_USER_PROFILE_STRING:"Default",GIT_ASKPASS:"c:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\resources\\app\\extensions\\git\\dist\\askpass.sh",HOME:"C:\\Users\\tantra",HOMEDRIVE:"C:",HOMEPATH:"\\Users\\tantra",INIT_CWD:"C:\\Users\\tantra\\Desktop\\nostrpay",IOLIBS:"C:\\Program Files\\darktable\\lib\\libgphoto2_port\\0.12.2",JAVA_HOME:"C:\\Program Files\\Java\\jdk-17",LANG:"en_US.UTF-8",LOCALAPPDATA:"C:\\Users\\tantra\\AppData\\Local",LOGONSERVER:"\\\\DESKTOP-4JB96TD",NODE:"C:\\nvm4w\\nodejs\\node.exe",npm_command:"run-script",npm_config_cache:"C:\\Users\\tantra\\AppData\\Local\\npm-cache",npm_config_globalconfig:"C:\\Users\\tantra\\AppData\\Roaming\\npm\\etc\\npmrc",npm_config_global_prefix:"C:\\Users\\tantra\\AppData\\Roaming\\npm",npm_config_init_module:"C:\\Users\\tantra\\.npm-init.js",npm_config_local_prefix:"C:\\Users\\tantra\\Desktop\\nostrpay",npm_config_node_gyp:"C:\\Users\\tantra\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js",npm_config_noproxy:"",npm_config_npm_version:"11.3.0",npm_config_prefix:"C:\\Users\\tantra\\AppData\\Roaming\\npm",npm_config_userconfig:"C:\\Users\\tantra\\.npmrc",npm_config_user_agent:"npm/11.3.0 node/v22.19.0 win32 x64 workspaces/false",npm_execpath:"C:\\Users\\tantra\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",npm_lifecycle_event:"build",npm_lifecycle_script:"webpack --mode production",npm_node_execpath:"C:\\nvm4w\\nodejs\\node.exe",npm_package_json:"C:\\Users\\tantra\\Desktop\\nostrpay\\package.json",npm_package_name:"pubpay",npm_package_version:"0.0.0",NUMBER_OF_PROCESSORS:"22",NVM_HOME:"C:\\Users\\tantra\\AppData\\Local\\nvm",NVM_SYMLINK:"C:\\nvm4w\\nodejs",OneDrive:"C:\\Users\\tantra\\OneDrive",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",OS:"Windows_NT",Path:"C:\\Users\\tantra\\Desktop\\nostrpay\\node_modules\\.bin;C:\\Users\\tantra\\Desktop\\node_modules\\.bin;C:\\Users\\tantra\\node_modules\\.bin;C:\\Users\\node_modules\\.bin;C:\\node_modules\\.bin;C:\\Users\\tantra\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Program Files\\Common Files\\Oracle\\Java\\javapath;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Windows\\System32\\OpenSSH\\;C:\\Program Files\\Git\\cmd;%ANDROID_HOME%\\platform-tools;C:\\Program Files\\NVIDIA Corporation\\NVIDIA app\\NvDLISR;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Strawberry\\c\\bin;C:\\Strawberry\\perl\\site\\bin;C:\\Strawberry\\perl\\bin;C:\\Program Files\\GitHub CLI\\;%NVM_HOME%;%NVM_SYMLINK%;C:\\Program Files\\Docker\\Docker\\resources\\bin;C:\\Users\\tantra\\.cargo\\bin;C:\\Users\\tantra\\scoop\\shims;C:\\Users\\tantra\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\tantra\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Users\\tantra\\.bun\\bin;C:\\Users\\tantra\\AppData\\Roaming\\npm;C:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;C:\\Users\\tantra\\AppData\\Local\\nvm;C:\\nvm4w\\nodejs",PATHEXT:".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL",PROCESSOR_ARCHITECTURE:"AMD64",PROCESSOR_IDENTIFIER:"Intel64 Family 6 Model 170 Stepping 4, GenuineIntel",PROCESSOR_LEVEL:"6",PROCESSOR_REVISION:"aa04",ProgramData:"C:\\ProgramData",ProgramFiles:"C:\\Program Files","ProgramFiles(x86)":"C:\\Program Files (x86)",ProgramW6432:"C:\\Program Files",PROMPT:"$P$G",PSModulePath:"C:\\Users\\tantra\\Documents\\WindowsPowerShell\\Modules;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules",PUBLIC:"C:\\Users\\Public",SESSIONNAME:"Console",SystemDrive:"C:",SystemRoot:"C:\\Windows",TEMP:"C:\\Users\\tantra\\AppData\\Local\\Temp",TERM_PROGRAM:"vscode",TERM_PROGRAM_VERSION:"1.6.45",TMP:"C:\\Users\\tantra\\AppData\\Local\\Temp",USERDOMAIN:"DESKTOP-4JB96TD",USERDOMAIN_ROAMINGPROFILE:"DESKTOP-4JB96TD",USERNAME:"tantra",USERPROFILE:"C:\\Users\\tantra",VBOX_MSI_INSTALL_PATH:"C:\\Program Files\\Oracle\\VirtualBox\\",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",VSCODE_GIT_ASKPASS_MAIN:"c:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\resources\\app\\extensions\\git\\dist\\askpass-main.js",VSCODE_GIT_ASKPASS_NODE:"C:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\Cursor.exe",VSCODE_GIT_IPC_HANDLE:"\\\\.\\pipe\\vscode-git-e3cb8cb4de-sock",VSCODE_INJECTION:"1",windir:"C:\\Windows",ZES_ENABLE_SYSMAN:"1"}?.REACT_APP_LNBITS_URL||"",apiKey:"undefined"!=typeof process&&{ALLUSERSPROFILE:"C:\\ProgramData",ANDROID_HOME:"C:\\Users\\tantra\\AppData\\Local\\Android\\Sdk",APPDATA:"C:\\Users\\tantra\\AppData\\Roaming",CAMLIBS:"C:\\Program Files\\darktable\\lib\\libgphoto2\\2.5.31",CHROME_CRASHPAD_PIPE_NAME:"\\\\.\\pipe\\crashpad_21040_EGQPETFNPSMQWLBU",COLOR:"1",COLORTERM:"truecolor",CommonProgramFiles:"C:\\Program Files\\Common Files","CommonProgramFiles(x86)":"C:\\Program Files (x86)\\Common Files",CommonProgramW6432:"C:\\Program Files\\Common Files",COMPUTERNAME:"DESKTOP-4JB96TD",ComSpec:"C:\\Windows\\system32\\cmd.exe",CURSOR_TRACE_ID:"6feaa83eb99f452084eacea2d37d1776",DriverData:"C:\\Windows\\System32\\Drivers\\DriverData",EDITOR:"C:\\Windows\\notepad.exe",EFC_15356_1592913036:"1",EFC_15356_2283032206:"1",EFC_15356_2775293581:"1",EFC_15356_3789132940:"1",FPS_BROWSER_APP_PROFILE_STRING:"Internet Explorer",FPS_BROWSER_USER_PROFILE_STRING:"Default",GIT_ASKPASS:"c:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\resources\\app\\extensions\\git\\dist\\askpass.sh",HOME:"C:\\Users\\tantra",HOMEDRIVE:"C:",HOMEPATH:"\\Users\\tantra",INIT_CWD:"C:\\Users\\tantra\\Desktop\\nostrpay",IOLIBS:"C:\\Program Files\\darktable\\lib\\libgphoto2_port\\0.12.2",JAVA_HOME:"C:\\Program Files\\Java\\jdk-17",LANG:"en_US.UTF-8",LOCALAPPDATA:"C:\\Users\\tantra\\AppData\\Local",LOGONSERVER:"\\\\DESKTOP-4JB96TD",NODE:"C:\\nvm4w\\nodejs\\node.exe",npm_command:"run-script",npm_config_cache:"C:\\Users\\tantra\\AppData\\Local\\npm-cache",npm_config_globalconfig:"C:\\Users\\tantra\\AppData\\Roaming\\npm\\etc\\npmrc",npm_config_global_prefix:"C:\\Users\\tantra\\AppData\\Roaming\\npm",npm_config_init_module:"C:\\Users\\tantra\\.npm-init.js",npm_config_local_prefix:"C:\\Users\\tantra\\Desktop\\nostrpay",npm_config_node_gyp:"C:\\Users\\tantra\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js",npm_config_noproxy:"",npm_config_npm_version:"11.3.0",npm_config_prefix:"C:\\Users\\tantra\\AppData\\Roaming\\npm",npm_config_userconfig:"C:\\Users\\tantra\\.npmrc",npm_config_user_agent:"npm/11.3.0 node/v22.19.0 win32 x64 workspaces/false",npm_execpath:"C:\\Users\\tantra\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",npm_lifecycle_event:"build",npm_lifecycle_script:"webpack --mode production",npm_node_execpath:"C:\\nvm4w\\nodejs\\node.exe",npm_package_json:"C:\\Users\\tantra\\Desktop\\nostrpay\\package.json",npm_package_name:"pubpay",npm_package_version:"0.0.0",NUMBER_OF_PROCESSORS:"22",NVM_HOME:"C:\\Users\\tantra\\AppData\\Local\\nvm",NVM_SYMLINK:"C:\\nvm4w\\nodejs",OneDrive:"C:\\Users\\tantra\\OneDrive",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",OS:"Windows_NT",Path:"C:\\Users\\tantra\\Desktop\\nostrpay\\node_modules\\.bin;C:\\Users\\tantra\\Desktop\\node_modules\\.bin;C:\\Users\\tantra\\node_modules\\.bin;C:\\Users\\node_modules\\.bin;C:\\node_modules\\.bin;C:\\Users\\tantra\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Program Files\\Common Files\\Oracle\\Java\\javapath;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Windows\\System32\\OpenSSH\\;C:\\Program Files\\Git\\cmd;%ANDROID_HOME%\\platform-tools;C:\\Program Files\\NVIDIA Corporation\\NVIDIA app\\NvDLISR;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Strawberry\\c\\bin;C:\\Strawberry\\perl\\site\\bin;C:\\Strawberry\\perl\\bin;C:\\Program Files\\GitHub CLI\\;%NVM_HOME%;%NVM_SYMLINK%;C:\\Program Files\\Docker\\Docker\\resources\\bin;C:\\Users\\tantra\\.cargo\\bin;C:\\Users\\tantra\\scoop\\shims;C:\\Users\\tantra\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\tantra\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Users\\tantra\\.bun\\bin;C:\\Users\\tantra\\AppData\\Roaming\\npm;C:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;C:\\Users\\tantra\\AppData\\Local\\nvm;C:\\nvm4w\\nodejs",PATHEXT:".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL",PROCESSOR_ARCHITECTURE:"AMD64",PROCESSOR_IDENTIFIER:"Intel64 Family 6 Model 170 Stepping 4, GenuineIntel",PROCESSOR_LEVEL:"6",PROCESSOR_REVISION:"aa04",ProgramData:"C:\\ProgramData",ProgramFiles:"C:\\Program Files","ProgramFiles(x86)":"C:\\Program Files (x86)",ProgramW6432:"C:\\Program Files",PROMPT:"$P$G",PSModulePath:"C:\\Users\\tantra\\Documents\\WindowsPowerShell\\Modules;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules",PUBLIC:"C:\\Users\\Public",SESSIONNAME:"Console",SystemDrive:"C:",SystemRoot:"C:\\Windows",TEMP:"C:\\Users\\tantra\\AppData\\Local\\Temp",TERM_PROGRAM:"vscode",TERM_PROGRAM_VERSION:"1.6.45",TMP:"C:\\Users\\tantra\\AppData\\Local\\Temp",USERDOMAIN:"DESKTOP-4JB96TD",USERDOMAIN_ROAMINGPROFILE:"DESKTOP-4JB96TD",USERNAME:"tantra",USERPROFILE:"C:\\Users\\tantra",VBOX_MSI_INSTALL_PATH:"C:\\Program Files\\Oracle\\VirtualBox\\",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",VSCODE_GIT_ASKPASS_MAIN:"c:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\resources\\app\\extensions\\git\\dist\\askpass-main.js",VSCODE_GIT_ASKPASS_NODE:"C:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\Cursor.exe",VSCODE_GIT_IPC_HANDLE:"\\\\.\\pipe\\vscode-git-e3cb8cb4de-sock",VSCODE_INJECTION:"1",windir:"C:\\Windows",ZES_ENABLE_SYSMAN:"1"}?.REACT_APP_LNBITS_API_KEY||"",webhookUrl:"undefined"!=typeof process&&{ALLUSERSPROFILE:"C:\\ProgramData",ANDROID_HOME:"C:\\Users\\tantra\\AppData\\Local\\Android\\Sdk",APPDATA:"C:\\Users\\tantra\\AppData\\Roaming",CAMLIBS:"C:\\Program Files\\darktable\\lib\\libgphoto2\\2.5.31",CHROME_CRASHPAD_PIPE_NAME:"\\\\.\\pipe\\crashpad_21040_EGQPETFNPSMQWLBU",COLOR:"1",COLORTERM:"truecolor",CommonProgramFiles:"C:\\Program Files\\Common Files","CommonProgramFiles(x86)":"C:\\Program Files (x86)\\Common Files",CommonProgramW6432:"C:\\Program Files\\Common Files",COMPUTERNAME:"DESKTOP-4JB96TD",ComSpec:"C:\\Windows\\system32\\cmd.exe",CURSOR_TRACE_ID:"6feaa83eb99f452084eacea2d37d1776",DriverData:"C:\\Windows\\System32\\Drivers\\DriverData",EDITOR:"C:\\Windows\\notepad.exe",EFC_15356_1592913036:"1",EFC_15356_2283032206:"1",EFC_15356_2775293581:"1",EFC_15356_3789132940:"1",FPS_BROWSER_APP_PROFILE_STRING:"Internet Explorer",FPS_BROWSER_USER_PROFILE_STRING:"Default",GIT_ASKPASS:"c:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\resources\\app\\extensions\\git\\dist\\askpass.sh",HOME:"C:\\Users\\tantra",HOMEDRIVE:"C:",HOMEPATH:"\\Users\\tantra",INIT_CWD:"C:\\Users\\tantra\\Desktop\\nostrpay",IOLIBS:"C:\\Program Files\\darktable\\lib\\libgphoto2_port\\0.12.2",JAVA_HOME:"C:\\Program Files\\Java\\jdk-17",LANG:"en_US.UTF-8",LOCALAPPDATA:"C:\\Users\\tantra\\AppData\\Local",LOGONSERVER:"\\\\DESKTOP-4JB96TD",NODE:"C:\\nvm4w\\nodejs\\node.exe",npm_command:"run-script",npm_config_cache:"C:\\Users\\tantra\\AppData\\Local\\npm-cache",npm_config_globalconfig:"C:\\Users\\tantra\\AppData\\Roaming\\npm\\etc\\npmrc",npm_config_global_prefix:"C:\\Users\\tantra\\AppData\\Roaming\\npm",npm_config_init_module:"C:\\Users\\tantra\\.npm-init.js",npm_config_local_prefix:"C:\\Users\\tantra\\Desktop\\nostrpay",npm_config_node_gyp:"C:\\Users\\tantra\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js",npm_config_noproxy:"",npm_config_npm_version:"11.3.0",npm_config_prefix:"C:\\Users\\tantra\\AppData\\Roaming\\npm",npm_config_userconfig:"C:\\Users\\tantra\\.npmrc",npm_config_user_agent:"npm/11.3.0 node/v22.19.0 win32 x64 workspaces/false",npm_execpath:"C:\\Users\\tantra\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",npm_lifecycle_event:"build",npm_lifecycle_script:"webpack --mode production",npm_node_execpath:"C:\\nvm4w\\nodejs\\node.exe",npm_package_json:"C:\\Users\\tantra\\Desktop\\nostrpay\\package.json",npm_package_name:"pubpay",npm_package_version:"0.0.0",NUMBER_OF_PROCESSORS:"22",NVM_HOME:"C:\\Users\\tantra\\AppData\\Local\\nvm",NVM_SYMLINK:"C:\\nvm4w\\nodejs",OneDrive:"C:\\Users\\tantra\\OneDrive",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",OS:"Windows_NT",Path:"C:\\Users\\tantra\\Desktop\\nostrpay\\node_modules\\.bin;C:\\Users\\tantra\\Desktop\\node_modules\\.bin;C:\\Users\\tantra\\node_modules\\.bin;C:\\Users\\node_modules\\.bin;C:\\node_modules\\.bin;C:\\Users\\tantra\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Program Files\\Common Files\\Oracle\\Java\\javapath;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Windows\\System32\\OpenSSH\\;C:\\Program Files\\Git\\cmd;%ANDROID_HOME%\\platform-tools;C:\\Program Files\\NVIDIA Corporation\\NVIDIA app\\NvDLISR;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Strawberry\\c\\bin;C:\\Strawberry\\perl\\site\\bin;C:\\Strawberry\\perl\\bin;C:\\Program Files\\GitHub CLI\\;%NVM_HOME%;%NVM_SYMLINK%;C:\\Program Files\\Docker\\Docker\\resources\\bin;C:\\Users\\tantra\\.cargo\\bin;C:\\Users\\tantra\\scoop\\shims;C:\\Users\\tantra\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\tantra\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Users\\tantra\\.bun\\bin;C:\\Users\\tantra\\AppData\\Roaming\\npm;C:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\resources\\app\\bin;C:\\Users\\tantra\\AppData\\Local\\nvm;C:\\nvm4w\\nodejs",PATHEXT:".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL",PROCESSOR_ARCHITECTURE:"AMD64",PROCESSOR_IDENTIFIER:"Intel64 Family 6 Model 170 Stepping 4, GenuineIntel",PROCESSOR_LEVEL:"6",PROCESSOR_REVISION:"aa04",ProgramData:"C:\\ProgramData",ProgramFiles:"C:\\Program Files","ProgramFiles(x86)":"C:\\Program Files (x86)",ProgramW6432:"C:\\Program Files",PROMPT:"$P$G",PSModulePath:"C:\\Users\\tantra\\Documents\\WindowsPowerShell\\Modules;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules",PUBLIC:"C:\\Users\\Public",SESSIONNAME:"Console",SystemDrive:"C:",SystemRoot:"C:\\Windows",TEMP:"C:\\Users\\tantra\\AppData\\Local\\Temp",TERM_PROGRAM:"vscode",TERM_PROGRAM_VERSION:"1.6.45",TMP:"C:\\Users\\tantra\\AppData\\Local\\Temp",USERDOMAIN:"DESKTOP-4JB96TD",USERDOMAIN_ROAMINGPROFILE:"DESKTOP-4JB96TD",USERNAME:"tantra",USERPROFILE:"C:\\Users\\tantra",VBOX_MSI_INSTALL_PATH:"C:\\Program Files\\Oracle\\VirtualBox\\",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",VSCODE_GIT_ASKPASS_MAIN:"c:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\resources\\app\\extensions\\git\\dist\\askpass-main.js",VSCODE_GIT_ASKPASS_NODE:"C:\\Users\\tantra\\AppData\\Local\\Programs\\cursor\\Cursor.exe",VSCODE_GIT_IPC_HANDLE:"\\\\.\\pipe\\vscode-git-e3cb8cb4de-sock",VSCODE_INJECTION:"1",windir:"C:\\Windows",ZES_ENABLE_SYSMAN:"1"}?.REACT_APP_WEBHOOK_URL||""};w.current=new P(s),S.current=new E,console.log("Services initialized")}catch(e){console.error("Failed to initialize services:",e),console.error("Failed to initialize services. Please refresh the page.")}};e()},[]),(0,t.useEffect)(()=>(setTimeout(()=>{(()=>{if(!A.current)if(A.current=!0,new URLSearchParams(window.location.search).get("note"))console.log("Single note mode detected, skipping global feed load");else if(x.current&&"undefined"!=typeof window&&window.NostrTools)setTimeout(()=>{U("global")},1e3);else{const e=setInterval(()=>{x.current&&"undefined"!=typeof window&&window.NostrTools&&(new URLSearchParams(window.location.search).get("note")||U("global"),clearInterval(e))},1e3);setTimeout(()=>clearInterval(e),3e4)}})()},100),()=>{A.current=!1,x.current?.unsubscribeAll?.()}),[]),(0,t.useEffect)(()=>{L();const e=async()=>{if("visible"===document.visibilityState){const e=await _.handleExternalSignerReturn();e.success&&e.publicKey&&(_.storeAuthData(e.publicKey,null,"externalSigner",!1),b({isLoggedIn:!0,publicKey:e.publicKey,privateKey:null,signInMethod:"externalSigner",userProfile:null,displayName:null}),await O(e.publicKey))}};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]);const L=()=>{if(_.isAuthenticated()){const{publicKey:e,privateKey:s,method:n}=_.getStoredAuthData();b({isLoggedIn:!0,publicKey:e,privateKey:s,signInMethod:n,userProfile:null,displayName:null}),x.current&&e&&O(e)}},O=async e=>{if(x.current&&e)try{const s=(await N(d(),x.current,[e])).get(e);if(s){const e=g(s?.content||"{}",{}),n=e.display_name||e.displayName||e.name||null;b(e=>({...e,userProfile:s||null,displayName:n}))}}catch(e){console.error("Failed to load user profile:",e)}},U=async(e,n=!1)=>{if(x.current)if("undefined"!=typeof window&&window.NostrTools)try{n?h(!0):s(!0);const a={limit:21};if("following"===e&&I.current&&I.current.length>0&&(a.authors=[...I.current]),n){const s="following"===e?l:r;if(s.length>0){const e=s[s.length-1];e&&(a.until=e.createdAt,console.log("Loading more posts until:",e.createdAt,"for post:",e.id))}}const t=await(async(e,s,n)=>await e.ensureQueryData({queryKey:j(n),queryFn:()=>(async(e,s)=>{const n={kinds:[1],"#t":["pubpay"],limit:s.limit??21,...s.until?{until:s.until}:{}};return await e.getEvents([n])})(s,n),staleTime:1e4}))(d(),x.current,{until:a.until,limit:a.limit});if(!t||0===t.length)return void(n?h(!1):s(!1));const o=[...new Set(t.map(e=>e.pubkey))],p=Array.from((await N(d(),x.current,o)).values()),m=t.map(e=>e.id),u=await C(d(),x.current,m),g=new Set;u.forEach(e=>{const s=e.tags.find(e=>"description"===e[0]);let n=!1;if(s)try{const e=f(s[1]||void 0)||{};e.pubkey&&(g.add(e.pubkey),n=!0)}catch{}n||g.add(e.pubkey)});const y=g.size>0?Array.from((await B(Array.from(g))).values()):[],b=[...p,...y],v=await M(t,b);n?("following"===e?c(e=>{const s=new Set(e.map(e=>e.id)),n=v.filter(e=>!s.has(e.id));return console.log(`Adding ${n.length} new posts (${v.length-n.length} duplicates filtered)`),[...e,...n]}):i(e=>{const s=new Set(e.map(e=>e.id)),n=v.filter(e=>!s.has(e.id));return console.log(`Adding ${n.length} new posts (${v.length-n.length} duplicates filtered)`),[...e,...n]}),h(!1)):("following"===e?c(v):i(v),s(!1)),u.length>0&&await z(t,u,e)}catch(e){console.error("Failed to load posts:",e),console.error("Failed to load posts:",e instanceof Error?e.message:"Failed to load posts"),s(!1),h(!1)}else console.warn("NostrTools not available yet");else console.warn("NostrClient not available yet")},M=async(e,s)=>{const n=[],a=new Set;e.forEach(e=>{const s=e.tags.find(e=>"zap-payer"===e[0]);s&&s[1]&&a.add(s[1])});let t=[];if(a.size>0){const e=await B(Array.from(a));t=Array.from(e.values())}const o=[...s,...t];for(const s of e){const e=o.find(e=>e.pubkey===s.pubkey),a={id:s.id,event:s,author:e||{kind:0,id:"",pubkey:s.pubkey,content:"{}",created_at:0,sig:"",tags:[]},createdAt:s.created_at,zapMin:0,zapMax:0,zapUses:0,zapAmount:0,zaps:[],zapUsesCurrent:0,isPayable:!0,content:s.content},t=s.tags.find(e=>"zap-min"===e[0]),r=s.tags.find(e=>"zap-max"===e[0]),i=s.tags.find(e=>"zap-uses"===e[0]),l=s.tags.find(e=>"zap-payer"===e[0]),c=s.tags.find(e=>"zap-lnurl"===e[0]);if(t&&t[1]&&(a.zapMin=parseInt(t[1])/1e3||0),r&&r[1]&&(a.zapMax=parseInt(r[1])/1e3||0),i&&i[1]&&(a.zapUses=parseInt(i[1])||0),l&&l[1]){a.zapPayer=l[1];const e=o.find(e=>e.pubkey===l[1]);if(e)try{const s=g(e.content,{});a.zapPayerPicture=s.picture||"/images/generic-user-icon.svg"}catch{a.zapPayerPicture="/images/generic-user-icon.svg"}else a.zapPayerPicture="/images/generic-user-icon.svg"}c&&c[1]&&(a.zapLNURL=c[1]);try{const e=!!(a.author?g(a.author.content||"{}",{}):{}).lud16;a.isPayable=e||!!a.zapLNURL}catch{a.isPayable=!!a.zapLNURL}n.push(a)}return n.sort((e,s)=>s.createdAt-e.createdAt)},z=async(e,s,n)=>{const a=e.map(e=>e.id),t=s.filter(e=>e.tags.some(e=>"e"===e[0]&&e[1]&&a.includes(e[1])));if(0===t.length)return;const o=new Set;t.forEach(e=>{const s=e.tags.find(e=>"description"===e[0]);let n=!1;if(s)try{const e=f(s[1]||void 0)||{};e.pubkey&&(o.add(e.pubkey),n=!0)}catch{}n||o.add(e.pubkey)});const r=o.size>0?Array.from((await B(Array.from(o))).values()):[],l=e=>e.map(e=>{let s=t.filter(s=>s.tags.some(s=>"e"===s[0]&&s[1]===e.id));if(e.zapPayer&&(s=s.filter(s=>{const n=s.tags.find(e=>"description"===e[0]);if(n)try{return(f(n[1]||void 0)||{}).pubkey===e.zapPayer}catch{return!1}return!1})),s=s.reverse(),0===s.length)return e;const n=s.map(e=>{const s=e.tags.find(e=>"bolt11"===e[0]);let n=0;if(s&&window.lightningPayReq)try{n=window.lightningPayReq.decode(s[1]||"").satoshis||0}catch{n=0}const a=e.tags.find(e=>"description"===e[0]);let t=e.pubkey,o=!1;if(a)try{const e=f(a[1]||void 0)||{};e.pubkey?t=e.pubkey:o=!0}catch{o=!0}else o=!0;const i=r.find(e=>e.pubkey===t),l=i&&g(i.content||"{}",{}).picture||"/images/generic-user-icon.svg",c=window.NostrTools?window.NostrTools.nip19.npubEncode(t):t;return{...e,zapAmount:n,zapPayerPubkey:t,zapPayerPicture:l,zapPayerNpub:c}}),a=n.reduce((e,s)=>e+s.zapAmount,0),o=n.length;return{...e,zaps:n,zapAmount:a,zapUsesCurrent:o}});"following"===n?c(e=>l(e)):i(e=>l(e))},F=async(e,s,n)=>{const a=[];for(const t of e){const e=s.find(e=>e.pubkey===t.pubkey),o=n.filter(e=>e.tags.some(e=>"e"===e[0]&&e[1]===t.id)).reverse(),r=o.map(e=>{const n=e.tags.find(e=>"bolt11"===e[0]);let a=0;if(n&&window.lightningPayReq)try{a=window.lightningPayReq.decode(n[1]||"").satoshis||0}catch{a=0}const t=e.tags.find(e=>"description"===e[0]);let o="",r=!1;if(t)try{const e=f(t[1]||void 0)||{};o=e.pubkey||"",r=!e.pubkey}catch{o="",r=!0}else r=!0;r&&(o=e.pubkey);const i=s.find(e=>e.pubkey===o);let l="https://icon-library.com/images/generic-user-icon/generic-user-icon-10.jpg";if(i)try{l=g(i.content,{}).picture||"https://icon-library.com/images/generic-user-icon/generic-user-icon-10.jpg"}catch{l="https://icon-library.com/images/generic-user-icon/generic-user-icon-10.jpg"}const c=o&&window.NostrTools?window.NostrTools.nip19.npubEncode(o):"";return{...e,zapAmount:a,zapPayerPubkey:o,zapPayerPicture:l,zapPayerNpub:c}}),i=r.reduce((e,s)=>e+s.zapAmount,0),l=t.tags.find(e=>"zap-min"===e[0]),c=t.tags.find(e=>"zap-max"===e[0]),d=t.tags.find(e=>"zap-uses"===e[0]),p=t.tags.find(e=>"zap-payer"===e[0]),m=t.tags.find(e=>"zap-lnurl"===e[0]),u=l?parseInt(l[1]||"0")/1e3:0,h=c?parseInt(c[1]||"0")/1e3:u,y=d?parseInt(d[1]||"1"):1,b=o.length,v=p?.[1],x=m?.[1],N=!(!e||!g(e.content,{}).lud16)||!!x;a.push({id:t.id,event:t,author:e||null,zaps:r,zapAmount:i,zapMin:u,zapMax:h,zapUses:y,zapUsesCurrent:b,content:t.content,isPayable:N,zapPayer:v,zapLNURL:x,createdAt:t.created_at})}return a.sort((e,s)=>s.createdAt-e.createdAt)},K=()=>{Promise.resolve().then(n.bind(n,524)).then(({useUIStore:e})=>{e.getState().openLogin()}).catch(()=>{console.warn("UI store not available yet")})},W=async e=>{if(x.current)try{const s={kinds:[1],"#e":[e]},n=JSON.parse(JSON.stringify(s)),a=await x.current.getEvents([n]);if(!a||0===a.length)return void m([]);console.log("Found replies:",a.length);const t=[...new Set(a.map(e=>e.pubkey))],o=Array.from((await N(d(),x.current,t)).values()),r=a.map(e=>e.id),i=await C(d(),x.current,r),l=new Set;i.forEach(e=>{const s=e.tags.find(e=>"description"===e[0]);let n=!1;if(s)try{const e=JSON.parse(s[1]||"{}");e.pubkey&&(l.add(e.pubkey),n=!0)}catch{}n||l.add(e.pubkey)});const c=l.size>0?await x.current.getEvents([{kinds:[0],authors:Array.from(l)}]):[],p=[...o,...c],u=(e=>{const s=[],n=new Map;for(const a of e){let e=0;const t=a.event.tags.find(e=>"e"===e[0]&&"reply"===e[3]);if(t&&t[1]){const s=t[1],a=n.get(s);void 0!==a&&(e=a+1)}n.set(a.id,e),s.push({...a,replyLevel:e})}return s})((await F(a,p,i)).sort((e,s)=>e.createdAt-s.createdAt));m(u)}catch(e){console.error("Failed to load replies:",e)}};(0,t.useEffect)(()=>{if(!x.current||e)return()=>{};let s=null;if(r.length>0){const e=r.map(e=>e.id);s=x.current.subscribeToEvents([{kinds:[9735],"#e":e}],async e=>{if(9735===e.kind)if(k.current.push(e),T.current&&clearTimeout(T.current),k.current.length>=10){const e=[...k.current];k.current=[],await V(e)}else T.current=setTimeout(async()=>{const e=[...k.current];k.current=[],await V(e)},500)},{oneose:()=>{console.log("Zap subscription EOS")},onclosed:()=>{console.log("Zap subscription closed")}})}return()=>{s&&s.unsubscribe()}},[r.length,e]);const V=async e=>{if(0===e.length)return;const s=new Set;e.forEach(e=>{const n=e.tags.find(e=>"description"===e[0]);let a="";if(n)try{a=(f(n[1]||void 0)||{}).pubkey||""}catch{a=""}a||(a=e.pubkey),a&&s.add(a)});const a=await B(Array.from(s));for(const s of e){const e=await H(s,a);if(!e)continue;const t=s.tags.find(e=>"e"===e[0]);if(!t)continue;const o=t[1];try{const e=s.tags.find(e=>"description"===e[0]);let a="";if(e){const s=f(e[1]||void 0)||{};a=s.id||""}a&&Promise.resolve().then(n.bind(n,524)).then(({useUIStore:e})=>{const{eventId:s,show:n}=e.getState().invoiceOverlay;n&&s===a&&e.getState().closeInvoice()})}catch(e){}i(n=>{const a=[...n],t=a.findIndex(e=>e.id===o);if(-1===t)return a;const r=a[t];if(!r)return a;if(r.zaps.find(e=>e.id===s.id))return a;const i={...r,zaps:[...r.zaps,e],zapAmount:r.zapAmount+e.zapAmount,zapUsesCurrent:r.zapUsesCurrent+1};return a[t]=i,a}),c(n=>{const a=[...n],t=a.findIndex(e=>e.id===o);if(-1===t)return a;const r=a[t];if(!r)return a;if(r.zaps.find(e=>e.id===s.id))return a;const i={...r,zaps:[...r.zaps,e],zapAmount:r.zapAmount+e.zapAmount,zapUsesCurrent:r.zapUsesCurrent+1};return a[t]=i,a})}},B=async e=>{const s=new Map,n=[];for(const a of e){const e=R.current.get(a);e?s.set(a,e):D.current.has(a)||n.push(a)}if(n.length>0&&x.current){n.forEach(e=>D.current.add(e));try{const e=await N(d(),x.current,n);Array.from(e.values()).forEach(e=>{R.current.set(e.pubkey,e),s.set(e.pubkey,e)}),n.forEach(e=>D.current.delete(e))}catch(e){console.error("Error loading profiles:",e),n.forEach(e=>D.current.delete(e))}}return s},H=async(e,s)=>{try{const n=e.tags.find(e=>"bolt11"===e[0]);let a=0;if(n&&window.lightningPayReq)try{a=window.lightningPayReq.decode(n[1]).satoshis||0}catch{a=0}const t=e.tags.find(e=>"description"===e[0]);let o="",i=!1;if(t)try{const e=f(t[1]||void 0)||{};o=e.pubkey||"",i=!e.pubkey}catch{o="",i=!0}else i=!0;i&&(o=e.pubkey);const l=e.tags.find(e=>"e"===e[0]);if(l&&l[1]){const e=r.find(e=>e.id===l[1]);if(e&&e.zapPayer&&o!==e.zapPayer)return null}const c=o?s.get(o):null;let d="/images/generic-user-icon.svg";if(c)try{d=g(c.content,{}).picture||"/images/generic-user-icon.svg"}catch{d="/images/generic-user-icon.svg"}const p=o&&window.NostrTools?window.NostrTools.nip19.npubEncode(o):"";return{...e,zapAmount:a,zapPayerPubkey:o,zapPayerPicture:d,zapPayerNpub:p}}catch(e){return console.error("Error processing zap:",e),null}};return(0,t.useEffect)(()=>()=>{try{x.current&&x.current.destroy(),w.current&&w.current.destroy()}catch(e){console.warn("Error during cleanup:",e)}},[]),{isLoading:e,activeFeed:a,posts:r,followingPosts:l,replies:p,isLoadingMore:u,authState:y,handleFeedChange:e=>{"following"!==e||y.isLoggedIn?(o(e),"following"===e&&0===l.length&&(async()=>{if(y.isLoggedIn&&x.current)try{const e=await x.current.getEvents([{kinds:[3],authors:[y.publicKey]}]),s=[];for(const n of e){const e=n.tags.filter(e=>"p"===e[0]);s.push(...e.map(e=>e[1]).filter(e=>Boolean(e)))}I.current=s,await U("following")}catch(e){console.error("Failed to load following posts:",e),console.error("Failed to load following posts")}})()):K()},handleQRScanner:()=>{console.log("Opening QR scanner...")},handleLogin:K,handleNewPayNote:()=>{y.isLoggedIn?console.log("Opening new pay note form..."):K()},handleSignInExtension:async(e=!0)=>{try{const s=await _.signInWithExtension();return s.success&&s.publicKey?(_.storeAuthData(s.publicKey,s.privateKey||null,"extension",e),b({isLoggedIn:!0,publicKey:s.publicKey,privateKey:s.privateKey||null,signInMethod:"extension",userProfile:null,displayName:null}),await O(s.publicKey),{success:!0}):(console.error("Extension sign in failed:",s.error||"Extension sign in failed"),{success:!1,error:s.error||"Extension sign in failed"})}catch(e){return console.error("Extension sign in failed:",e),{success:!1,error:"Extension sign in failed"}}},handleSignInExternalSigner:async(e=!0)=>{try{const s=await _.signInWithExternalSigner(e);return s.success?{success:!0}:(console.error("External signer failed:",s.error||"External signer failed"),{success:!1,error:s.error||"External signer failed"})}catch(e){return console.error("External signer failed:",e),{success:!1,error:"External signer failed"}}},handleSignInNsec:()=>{console.log("Nsec sign in initiated...")},handleContinueWithNsec:async(e,s)=>{try{const n=await _.signInWithNsec(e);n.success&&n.publicKey?(_.storeAuthData(n.publicKey,n.privateKey||null,"nsec",s),b({isLoggedIn:!0,publicKey:n.publicKey,privateKey:n.privateKey||null,signInMethod:"nsec",userProfile:null,displayName:null}),await O(n.publicKey)):console.error("Nsec sign in failed:",n.error||"Invalid nsec")}catch(e){console.error("Nsec sign in failed:",e),console.error("Invalid nsec")}},handleLogout:()=>{_.clearAuthData(),b({isLoggedIn:!1,publicKey:null,privateKey:null,signInMethod:null,userProfile:null,displayName:null}),c([]),I.current=[]},handlePayWithExtension:async(e,s)=>{if(y.isLoggedIn)if(window.nostr)if(S.current)try{if(console.log("Processing zap payment:",s,"sats for post:",e.id),!e.author)return void console.error("No author data found");const n=await S.current.getInvoiceCallBack(e.event,e.author);if(!n)return void console.error("Failed to get Lightning callback");const a=y.publicKey;if(!a)return void console.error("No public key found");const t=await S.current.createZapEvent(e.event,s,n.lud16ToZap,a);if(!t)return void console.error("Failed to create zap event");await S.current.signZapEvent(t.zapEvent,n.callbackToZap,t.amountPay,n.lud16ToZap,e.id,!1)?console.log("Zap payment initiated successfully"):console.error("Failed to sign and send zap event")}catch(e){console.error("Payment failed:",e)}else console.error("Zap service not initialized");else console.error("Nostr extension not available");else K()},handlePayAnonymously:async(e,s)=>{if(S.current)try{if(console.log("Processing anonymous zap payment:",s,"sats for post:",e.id),!e.author)return void console.error("No author data found");const n=await S.current.getInvoiceCallBack(e.event,e.author);if(!n)return void console.error("Failed to get Lightning callback");const a=await S.current.createZapEvent(e.event,s,n.lud16ToZap,null);if(!a)return void console.error("Failed to create zap event");await S.current.signZapEvent(a.zapEvent,n.callbackToZap,a.amountPay,n.lud16ToZap,e.id,!0)?console.log("Anonymous zap payment initiated successfully"):console.error("Failed to initiate anonymous zap payment")}catch(e){console.error("Anonymous zap payment failed:",e)}else console.error("Zap service not initialized")},handlePayWithWallet:async(e,s)=>{try{console.log("Paying with wallet:",s,"sats for post:",e.id)}catch(e){console.error("Payment failed:",e),console.error("Payment failed")}},handleCopyInvoice:async e=>{try{await navigator.clipboard.writeText(e),console.log("Invoice copied to clipboard")}catch(e){console.error("Failed to copy invoice:",e),console.error("Failed to copy invoice")}},handlePostNote:async e=>{if(y.isLoggedIn)if(x.current)try{const{payNoteContent:s,paymentType:n,zapFixed:t,zapMin:o,zapMax:r,zapUses:i,zapPayer:l,overrideLNURL:c}=e;if(!s||""===s.trim())return void console.error("Please enter a payment request description");const d=[["t","pubpay"]];let p,m;if("fixed"===n){const e=parseInt(t??"1")||1;p=1e3*e,m=1e3*e}else{if("range"!==n)return void console.error("Please select a payment type");if(p=1e3*(parseInt(o??"1")||1),m=1e3*(parseInt(r??"1000000")||1e6),m<p)return void console.error("Maximum amount must be greater than minimum amount")}if(d.push(["zap-min",p.toString()]),d.push(["zap-max",m.toString()]),i&&parseInt(i)>0&&d.push(["zap-uses",i]),l&&""!==l.trim())try{const e=window.NostrTools.nip19.decode(l);if("npub"!==e.type)return void console.error("Invalid payer npub format");d.push(["zap-payer",e.data])}catch{return void console.error("Invalid payer npub format")}c&&""!==c.trim()&&d.push(["zap-lnurl",c]),d.push(["client","PubPay.me"]);const u=s.match(/(nostr:|@)?((npub)1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{58,})/gi);u&&u.forEach(e=>{try{const s=e.replace(/nostr:|@/g,""),n=window.NostrTools.nip19.decode(s);"npub"===n.type&&d.push(["p",n.data,"","mention"])}catch{console.warn("Failed to decode mention:",e)}});const h={kind:1,created_at:Math.floor(Date.now()/1e3),tags:d,content:s.trim(),pubkey:"",id:"",sig:""};let g;if("extension"===y.signInMethod){if(!window.nostr)return void console.error("Nostr extension not available");g=await window.nostr.signEvent(h)}else{if("nsec"!==y.signInMethod){if("externalSigner"===y.signInMethod){h.pubkey=y.publicKey,h.id=window.NostrTools.getEventHash(h);const e=JSON.stringify(h);return sessionStorage.setItem("SignKind1",JSON.stringify({event:h})),void(window.location.href=`nostrsigner:${e}?compressionType=none&returnType=signature&type=sign_event`)}return void console.error("Invalid sign-in method")}{if(!y.privateKey)return void console.error("Private key not available");const{data:e}=window.NostrTools.nip19.decode(y.privateKey);g=window.NostrTools.finalizeEvent(h,e)}}if(!window.NostrTools.verifyEvent(g))return void console.error("Invalid signed event");await x.current.publishEvent(g),console.log("Event published successfully"),await U(a)}catch(e){console.error("Failed to post note:",e),console.error("Failed to post note:",e instanceof Error?e.message:"Failed to post note")}else console.error("Nostr client not available");else K()},loadMorePosts:async()=>{if(!u)return("following"===a?l:r).length<21?void console.log("Not enough posts to load more, skipping..."):(console.log("Loading more posts..."),U(a,!0));console.log("Already loading more posts, skipping...")},loadSingleNote:async e=>{if(x.current)if("undefined"!=typeof window&&window.NostrTools)try{s(!0),i([]),m([]);const n={kinds:[1],ids:[e]},a=JSON.parse(JSON.stringify(n)),t=await x.current.getEvents([a]);if(!t||0===t.length)return console.log("Note not found"),void s(!1);console.log("Found single note:",t[0]);const o=t[0]?.pubkey;if(!o)return console.error("No author pubkey found"),void s(!1);const r=await N(d(),x.current,[o]),l=r.get(o)?[r.get(o)]:[],c=await C(d(),x.current,[e]),p=new Set;c.forEach(e=>{const s=e.tags.find(e=>"description"===e[0]);let n=!1;if(s)try{const e=f(s[1]||void 0)||{};e.pubkey&&(p.add(e.pubkey),n=!0)}catch{}n||p.add(e.pubkey)});const u=p.size>0?Array.from((await B(Array.from(p))).values()):[],h=[...l,...u],g=await F(t,h,c);g.length>0&&i(g),await W(e),s(!1)}catch(e){console.error("Failed to load single note:",e),s(!1)}else console.warn("NostrTools not available yet");else console.warn("NostrClient not available yet")},loadReplies:W}},A=t.memo(({post:e,onPay:s,onPayAnonymously:n,onShare:o,onViewRaw:r,isLoggedIn:i,isReply:l=!1})=>{const[c,d]=(0,t.useState)(e.zapMin),[p,m]=(0,t.useState)(!1),[u,h]=(0,t.useState)(""),[g,y]=(0,t.useState)([]),[f,b]=(0,t.useState)([]),v=(0,t.useRef)(null),x=(0,t.useRef)(null),N=(0,t.useRef)(null);(0,t.useEffect)(()=>{const e=e=>{v.current&&N.current&&!v.current.contains(e.target)&&!N.current.contains(e.target)&&m(!1)};return p&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[p]);const w=e.author?(()=>{try{return JSON.parse(e.author.content||"{}")}catch{return null}})():null,S=w?.display_name||w?.name||"Anonymous",C=w?.picture||"/images/generic-user-icon.svg",j=w?.nip05,P=w?.lud16,_=e.isPayable&&(0===e.zapUses||e.zapUsesCurrent<e.zapUses);return(0,t.useEffect)(()=>{if(0===e.zaps.length)return y([]),void b([]);const s=[],n=[];e.zaps.forEach((a,t)=>{const o=a.zapAmount,r=e.zapMin,i=e.zapMax;o>=r&&o<=i?s.push(a):n.push(a)}),y(s),b(n)},[e.zaps,e.zapUsesCurrent,e.zapUses]),(0,t.useEffect)(()=>{const e=e=>{const s=e.target;if(!s.matches(".dropbtn")&&!s.matches(".dropdown-element")){const e=document.getElementsByClassName("dropdown-content");for(let s=0;s<e.length;s++)e[s].classList.remove("show")}},s=e=>{const s=e.target;if(!s.matches(".dropbtn")&&!s.matches(".dropdown-element")){const e=document.getElementsByClassName("dropdown-content");for(let s=0;s<e.length;s++)e[s].classList.remove("show")}};return document.addEventListener("click",e),document.addEventListener("touchstart",s),()=>{document.removeEventListener("click",e),document.removeEventListener("touchstart",s)}},[]),(0,a.jsxs)("div",{className:l?"paynote reply":"paynote",style:l?{marginLeft:15*(e.replyLevel||0)+15+"px"}:void 0,children:[(0,a.jsx)("div",{className:"noteProfileImg",children:(0,a.jsx)("img",{className:"userImg",src:C,alt:"Profile"})}),(0,a.jsxs)("div",{className:"noteData",children:[(0,a.jsxs)("div",{className:"noteHeader",children:[(0,a.jsxs)("div",{className:"noteAuthor",children:[(0,a.jsx)("div",{className:"noteDisplayName",children:(0,a.jsx)("a",{href:`https://next.nostrudel.ninja/#/u/${e.event.pubkey}`,className:"noteAuthorLink",target:"_blank",rel:"noopener noreferrer",children:S})}),(0,a.jsx)("div",{className:"noteNIP05 label",children:j?(0,a.jsxs)("a",{href:`https://${j.split("@")[1]}/.well-known/nostr.json?name=${j.split("@")[0]}`,target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"check_circle"}),j]}):(0,a.jsxs)("span",{className:"unverified label",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"block"}),"Unverified"]})}),(0,a.jsx)("div",{className:"noteLNAddress label",children:P?(0,a.jsxs)("a",{href:`https://${P.split("@")[1]}/.well-known/lnurlp/${P.split("@")[0]}`,target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"bolt"}),P]}):(0,a.jsx)("span",{children:"NOT PAYABLE"})})]}),(0,a.jsx)("div",{className:"noteDate label",onClick:()=>{if(console.log("noteDate clicked for post:",e.id),"undefined"!=typeof window&&window.NostrTools){const s=window.NostrTools.nip19.noteEncode(e.id);console.log("Navigating to single note:",s),window.location.href=`/?note=${s}`}else console.error("NostrTools not available")},style:{cursor:"pointer"},children:(e=>{const s=Date.now()-1e3*e,n=Math.floor(s/6e4),a=Math.floor(s/36e5),t=Math.floor(s/864e5);return n<60?`${n}m`:a<24?`${a}h`:`${t}d`})(e.createdAt)})]}),(0,a.jsx)("div",{className:"noteContent",dangerouslySetInnerHTML:{__html:(E=e.event.content,E=(E=(E=(E=(E=(E=E.replace(/(https?:\/\/[\w\-\.~:/?#[\]@!$&'()*+,;=%]+)\.(gif|png|jpg|jpeg)/gi,e=>`<img src="${e}" style="max-width: 100%; height: auto; border-radius: 8px; margin: 8px 0;">`)).replace(/(https?:\/\/[\w\-\.~:/?#[\]@!$&'()*+,;=%]+)\.(mp4|webm|ogg|mov)/gi,e=>`<div style="position: relative; width: 100%; height: 0; padding-bottom: 56.25%; margin: 8px 0;">\n        <video src="${e}" controls style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 8px;">\n          Your browser does not support the video tag.\n        </video>\n      </div>`)).replace(/(https?:\/\/(?:www\.)?youtube\.com\/watch\?v=([\w-]+)|https?:\/\/youtu\.be\/([\w-]+))/gi,(e,s,n)=>`<div style="position: relative; width: 100%; height: 0; padding-bottom: 56.25%; margin: 8px 0;">\n          <iframe src="https://www.youtube.com/embed/${n||s}" \n                  style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 8px;"\n                  frameborder="0" allowfullscreen>\n          </iframe>\n        </div>`)).replace(/(https?:\/\/[\w\-\.~:/?#[\]@!$&'()*+,;=%]+|www\.[\w\-\.~:/?#[\]@!$&'()*+,;=%]+)/gi,e=>E.includes(`src="${e}"`)?e:`<a href="${e.startsWith("http")?e:`http://${e}`}" target="_blank" rel="noopener noreferrer" style="color: #0066cc; text-decoration: underline;">${e}</a>`)).replace(/(nostr:|@)?((npub|nprofile)1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{58,})/gi,(e,s,n)=>{const a=n.replace("nostr:","").replace("@",""),t=a.length>35?`${a.substr(0,4)}...${a.substr(a.length-4)}`:a;return`<a href="https://next.nostrudel.ninja/#/u/${a}" \n                   target="_blank" \n                   rel="noopener noreferrer"\n                   style="color: #0066cc; text-decoration: underline;">\n                   ${t}\n                 </a>`})).replace(/\n/g,"<br />"))}}),(0,a.jsxs)("div",{className:"noteValues",children:[(0,a.jsxs)("div",{className:"zapMin",children:[(0,a.jsx)("span",{className:"zapMinVal",children:e.zapMin.toLocaleString()}),(0,a.jsxs)("span",{className:"label",children:["sats",(0,a.jsx)("br",{}),e.zapMin!==e.zapMax?"Min":""]})]}),e.zapMin!==e.zapMax&&(0,a.jsxs)("div",{className:"zapMax",children:[(0,a.jsx)("span",{className:"zapMaxVal",children:e.zapMax.toLocaleString()}),(0,a.jsxs)("span",{className:"label",children:["sats",(0,a.jsx)("br",{}),"Max"]})]}),e.zapUses>1&&(0,a.jsxs)("div",{className:"zapUses",children:[(0,a.jsx)("span",{className:"zapUsesCurrent",children:e.zapUsesCurrent}),(0,a.jsx)("span",{className:"label",children:"of"}),(0,a.jsx)("span",{className:"zapUsesTotal",children:e.zapUses})]})]}),e.zapPayer&&(0,a.jsxs)("div",{className:"zapPayer",children:["Payer ",(0,a.jsx)("span",{className:"material-symbols-outlined main-icon",children:"target"}),(0,a.jsxs)("div",{className:"zapPayerInner",children:[(0,a.jsx)("img",{className:"userImg",src:e.zapPayerPicture||"/images/generic-user-icon.svg"}),(0,a.jsx)("div",{className:"userName",children:(()=>{if(window.NostrTools){const s=window.NostrTools.nip19.npubEncode(e.zapPayer);return s.length>35?`${s.substr(0,4)}...${s.substr(s.length-4,s.length)}`:s}return`${e.zapPayer.substr(0,8)}...${e.zapPayer.substr(-8)}`})()})]})]}),e.zapLNURL&&(0,a.jsxs)("div",{className:"zapPayer",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"material-symbols-outlined main-icon",children:"double_arrow"})," Redirect to"]}),(0,a.jsx)("div",{className:"zapPayerInner",children:(0,a.jsx)("a",{href:e.zapLNURL,target:"_blank",rel:"noopener noreferrer",children:e.zapLNURL})})]}),e.zapMin!==e.zapMax&&_&&(0===e.zapUses||e.zapUsesCurrent<e.zapUses)&&(0,a.jsxs)("div",{className:"zapSliderContainer",children:[(0,a.jsx)("input",{type:"range",className:"zapSlider",min:e.zapMin,max:e.zapMax,value:c,onChange:e=>{return s=parseInt(e.target.value),void d(s);var s}}),(0,a.jsxs)("div",{className:"zapSliderVal",children:[c.toLocaleString(),(0,a.jsx)("span",{className:"label",children:" sats"})]})]}),(0,a.jsx)("div",{className:"noteHeroZaps noteZapReactions",children:g.map((e,s)=>(0,a.jsxs)("div",{className:"zapReaction",children:[(0,a.jsx)("a",{href:`https://next.nostrudel.ninja/#/u/${e.zapPayerNpub}`,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)("img",{className:"userImg",src:e.zapPayerPicture})}),(0,a.jsx)("a",{href:`https://next.nostrudel.ninja/#/n/${e.id}`,target:"_blank",rel:"noopener noreferrer",className:"zapReactionAmount",children:e.zapAmount?e.zapAmount.toLocaleString():"0"})]},s))}),(0,a.jsx)("div",{className:"noteCTA",children:(0,a.jsx)("button",{className:"noteMainCTA cta "+(_&&i&&!l?"":"disabled"),onClick:()=>!l&&_&&s(e,c),disabled:!_||!i||l,children:e.zapUses>0&&e.zapUsesCurrent>=e.zapUses?"Paid":"Pay"})}),(0,a.jsxs)("div",{className:"noteActionsReactions",children:[(0,a.jsx)("div",{className:"noteZaps noteZapReactions",children:f.map((e,s)=>(0,a.jsxs)("div",{className:"zapReaction",children:[(0,a.jsx)("a",{href:`https://next.nostrudel.ninja/#/u/${e.zapPayerNpub}`,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)("img",{className:"userImg",src:e.zapPayerPicture})}),(0,a.jsx)("a",{href:`https://next.nostrudel.ninja/#/n/${e.id}`,target:"_blank",rel:"noopener noreferrer",className:"zapReactionAmount",children:e.zapAmount?e.zapAmount.toLocaleString():"0"})]},s))}),(0,a.jsxs)("div",{className:"noteActions",children:[(0,a.jsxs)("a",{ref:N,className:_&&(0===e.zapUses||e.zapUsesCurrent<e.zapUses)?"noteAction zapMenuAction":"disabled",onClick:s=>{s.preventDefault(),!_||e.zapUses>0&&e.zapUsesCurrent>=e.zapUses||m(!p)},style:{position:"relative"},children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"bolt"}),(0,a.jsx)("div",{className:"zapMenu",style:{display:p?"block":"none"},ref:v,onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"zapMenuCustom",children:[(0,a.jsx)("input",{type:"number",id:"customZapInput",placeholder:"sats",min:"1",value:u,onChange:e=>h(e.target.value),onClick:e=>e.stopPropagation()}),(0,a.jsx)("button",{id:"customZapButton",onClick:n=>{n.stopPropagation(),(()=>{const n=parseInt(u);n>0&&(s(e,n),m(!1),h(""))})()},children:"Zap"}),(0,a.jsx)("button",{id:"customAnonZapButton",onClick:s=>{s.stopPropagation(),(()=>{const s=parseInt(u);s>0&&(n(e,s),m(!1),h(""))})()},children:"anonZap"})]})})]}),(0,a.jsx)("a",{className:"noteAction",onClick:()=>o(e),children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"ios_share"})}),(0,a.jsxs)("div",{className:"noteAction dropdown",children:[(0,a.jsx)("button",{className:"dropbtn",onClick:e=>{e.preventDefault(),e.stopPropagation(),console.log("Dropdown button clicked"),setTimeout(()=>{x.current&&(x.current.classList.toggle("show"),console.log("Dropdown classes after toggle:",x.current.className))},100)},children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"more_horiz"})}),(0,a.jsxs)("div",{className:"dropdown-content dropdown-element",ref:x,children:[(0,a.jsx)("a",{className:"cta dropdown-element disabled",children:"New Pay Forward"}),_&&(0,a.jsx)("a",{className:"cta dropdown-element "+(_?"":"disabled"),onClick:s=>{s.preventDefault(),_&&_&&n(e,c)},children:"Pay Anonymously"}),(0,a.jsx)("a",{className:"toolTipLink dropdown-element",href:"#",onClick:s=>{s.preventDefault(),r(e)},children:"View Raw"}),(0,a.jsx)("a",{href:`https://next.nostrudel.ninja/#/n/${e.id}`,className:"toolTipLink dropdown-element",target:"_blank",rel:"noopener noreferrer",children:"View on nostrudel"}),(0,a.jsx)("a",{href:`/live?note=${e.id}`,className:"toolTipLink dropdown-element",target:"_blank",rel:"noopener noreferrer",children:"View on live"})]})]})]})]})]})]});var E}),R=({bolt11:e})=>{const s=(0,t.useRef)(null);return(0,t.useEffect)(()=>{if(!e)return;const n=s.current;n&&(n.innerHTML="",window.QRCode&&window.QRCode.toCanvas(n,e).catch(()=>{}))},[e]),(0,a.jsx)("canvas",{id:"invoiceQR",ref:s})},D=()=>{const[e,s]=(0,t.useState)(!1),n=(0,p.useUIStore)(e=>e.loginForm.show),[o,r]=(0,t.useState)(!1),i=(0,p.useUIStore)(e=>e.invoiceOverlay.show),l=((0,p.useUIStore)(e=>e.openInvoice),(0,p.useUIStore)(e=>e.closeInvoice)),c=(0,p.useUIStore)(e=>e.openLogin),d=(0,p.useUIStore)(e=>e.closeLogin),[m,u]=(0,t.useState)(!1),[h,g]=(0,t.useState)(""),[y,f]=(0,t.useState)(!1),[b,v]=(0,t.useState)("fixed"),[x,N]=(0,t.useState)(!1),[w,S]=(0,t.useState)(""),[C,j]=(0,t.useState)(!1),[P,_]=(0,t.useState)(null),[E,D]=(0,t.useState)(!0),[k,T]=(0,t.useState)(!0),[L,O]=(0,t.useState)(!1),[U,M]=(0,t.useState)(!1),[z,F]=(0,t.useState)(""),{isLoading:K,activeFeed:W,posts:V,followingPosts:B,replies:H,isLoadingMore:G,authState:$,handleFeedChange:J,handleQRScanner:q,handleLogin:Z,handleNewPayNote:Y,handleSignInExtension:Q,handleSignInExternalSigner:X,handleSignInNsec:ee,handleContinueWithNsec:se,handleLogout:ne,handlePayWithExtension:ae,handlePayAnonymously:te,handlePayWithWallet:oe,handleCopyInvoice:re,handlePostNote:ie,loadMorePosts:le,loadSingleNote:ce,loadReplies:de}=((0,t.useRef)(null),I()),pe=()=>{N(!1),S("")},me=async e=>{const s=e.id,n=`${window.location.origin}/?note=${s}`;if(navigator.share)try{await navigator.share({title:"Check out this PubPay!",text:"Here's a PubPay I want to share with you:",url:n})}catch(e){console.error("Error sharing the link:",e)}else try{await navigator.clipboard.writeText(n),alert("Link copied to clipboard!")}catch(e){console.error("Failed to copy the link:",e)}},ue=e=>{g(JSON.stringify(e.event,null,2)),u(!0)},[he,ge]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{D(!0),T(!0)},[]),(0,t.useEffect)(()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get("note");if(e)try{const s=window.NostrTools.nip19.decode(e);if("note"!==s.type)return void console.error("Invalid type.");if(!/^[0-9a-f]{64}$/.test(s.data))return void console.error("Invalid event ID format.");M(!0),F(s.data),ce(s.data)}catch(e){console.error("Failed to decode note parameter:",e)}};if(e(),"undefined"!=typeof window&&window.NostrTools);else{const s=setInterval(()=>{"undefined"!=typeof window&&window.NostrTools&&(e(),clearInterval(s))},1e3);setTimeout(()=>clearInterval(s),3e4)}},[]),(0,t.useEffect)(()=>{let e,s=!1;const n=()=>{e&&clearTimeout(e),e=setTimeout(()=>{s||G||U||window.innerHeight+window.scrollY>=document.body.offsetHeight-100&&(s=!0,le().finally(()=>{s=!1}))},150)};return window.addEventListener("scroll",n),()=>{window.removeEventListener("scroll",n),e&&clearTimeout(e)}},[G,U,V.length]),(0,t.useEffect)(()=>{const e=async()=>{if("visible"===document.visibilityState){for(;!document.hasFocus();)await new Promise(e=>setTimeout(e,100));const e=JSON.parse(sessionStorage.getItem("signIn")||"null");if(e&&void 0!==e.rememberMe){sessionStorage.removeItem("signIn");try{const s=await navigator.clipboard.readText(),n=window.NostrTools.nip19.decode(s).data;!0===e.rememberMe?(localStorage.setItem("publicKey",n),localStorage.setItem("signInMethod","externalSigner")):(sessionStorage.setItem("publicKey",n),sessionStorage.setItem("signInMethod","externalSigner")),O(!1),T(!0),d(),window.location.reload()}catch(e){console.error("Failed to process external signer return:",e),O(!1),T(!1)}}}};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),(0,t.useEffect)(()=>{e&&!P&&"undefined"!=typeof window&&window.Html5Qrcode&&setTimeout(()=>{if(document.getElementById("reader")){const e=new window.Html5Qrcode("reader");_(e),e.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},async n=>{console.log("QR Code scanned:",n),e.stop().then(()=>{s(!1)}),await(async e=>{try{const s=/(note1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{58,}|nevent1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{58,})/i,n=e.match(s);if(!n)return;if(e=n[0],"undefined"!=typeof window&&window.NostrTools){const s=window.NostrTools.nip19.decode(e);if("note"===s.type)window.location.href=`/?note=${e}`;else if("nevent"===s.type){const e=s.data.id,n=window.NostrTools.nip19.noteEncode(e);window.location.href=`/?note=${n}`}else console.error("Invalid QR code content. Expected 'note' or 'nevent'.")}}catch(e){console.error("Failed to decode QR code content:",e)}})(n)},e=>{console.error("QR Code scanning error:",e)}).catch(e=>{console.error("Failed to start QR scanner:",e)})}},100)},[e]),(0,t.useEffect)(()=>{!e&&P&&P.getState().then(e=>{if("ACTIVE"===e||"PAUSED"===e)return P.stop()}).then(()=>{_(null)}).catch(e=>{console.error("Error stopping QR scanner:",e),_(null)})},[e,P]),(0,t.useEffect)(()=>()=>{P&&P.getState().then(e=>{if("ACTIVE"===e||"PAUSED"===e)return P.stop()}).catch(e=>{console.error("Error stopping QR scanner on unmount:",e)})},[P]),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{id:"nav",children:(0,a.jsxs)("div",{id:"navInner",children:[(0,a.jsxs)("a",{id:"logo",href:"/",children:["PUB",(0,a.jsx)("span",{style:{color:"#000"},children:"PAY"}),(0,a.jsx)("span",{style:{color:"#0000001c"},children:".me"}),(0,a.jsx)("span",{className:"version",children:"alpha 0.02"})]}),(0,a.jsxs)("div",{id:"navActions",children:[(0,a.jsx)("a",{id:"scanQrCode",className:"topAction",title:"Scan QR Code",onClick:()=>{s(!0)},children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"photo_camera"})}),(0,a.jsx)("a",{id:"settings",href:"#",style:{display:"none"},className:"topAction disabled",title:"coming soon",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"settings"})}),(0,a.jsx)("a",{id:"login",href:"#",className:"topAction",onClick:()=>{$.isLoggedIn?r(!0):(pe(),c())},children:$.isLoggedIn&&$.userProfile?(0,a.jsx)("img",{className:"userImg currentUserImg",src:(()=>{try{return JSON.parse($.userProfile.content||"{}").picture}catch{return}})()||"/images/generic-user-icon.svg",alt:"Profile"}):(0,a.jsx)("span",{className:"material-symbols-outlined",children:"account_circle"})}),(0,a.jsxs)("a",{id:"newPayNote",className:"cta",href:"#",onClick:()=>{$.isLoggedIn?(f(!0),v("fixed")):Y()},children:["New ",(0,a.jsx)("span",{className:"hideOnMobile",children:"Paynote"})]})]})]})}),(0,a.jsxs)("div",{id:"container",children:[(0,a.jsxs)("div",{id:"feedSelector",style:U?{display:"none"}:void 0,children:[(0,a.jsx)("a",{href:"#",id:"feedGlobal",className:"feedSelectorLink "+("global"===W?"active":""),onClick:()=>J("global"),children:"Global"}),(0,a.jsx)("a",{href:"#",id:"feedFollowing",className:"feedSelectorLink "+("following"===W?"active":""),onClick:()=>J("following"),children:"Following"}),(0,a.jsx)("a",{href:"#",className:"feedSelectorLink disabled",title:"coming soon",children:"High Rollers"})]}),(0,a.jsxs)("div",{id:"main",style:{display:"global"===W||U?"block":"none"},children:[K&&0===V.length?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"paynote blink",children:[(0,a.jsx)("div",{className:"noteProfileImg",children:(0,a.jsx)("img",{className:"userImg",src:"/images/generic-user-icon.svg",alt:"Profile"})}),(0,a.jsxs)("div",{className:"noteData",children:[(0,a.jsxs)("div",{className:"noteHeader",children:[(0,a.jsxs)("div",{className:"noteAuthor",children:[(0,a.jsx)("div",{className:"noteDisplayName",children:(0,a.jsx)("a",{href:"#",className:"noteAuthorLink disabled",target:"_blank",children:"Loading..."})}),(0,a.jsx)("div",{className:"noteNIP05 label",children:(0,a.jsxs)("a",{href:"#",target:"_blank",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"check_circle"}),"loading@example.com"]})}),(0,a.jsx)("div",{className:"noteLNAddress label",children:(0,a.jsxs)("a",{href:"#",target:"_blank",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"bolt"}),"loading@example.com"]})})]}),(0,a.jsx)("div",{className:"noteDate label",children:"Loading..."})]}),(0,a.jsx)("div",{className:"noteContent disabled",children:"Loading posts..."}),(0,a.jsxs)("div",{className:"noteValues",children:[(0,a.jsxs)("div",{className:"zapMin",children:[(0,a.jsx)("span",{className:"zapMinVal disabled",children:"Loading..."}),(0,a.jsxs)("span",{className:"label",children:["sats",(0,a.jsx)("br",{}),"Min"]})]}),(0,a.jsxs)("div",{className:"zapMax",children:[(0,a.jsx)("span",{className:"zapMaxVal disabled",children:"Loading..."}),(0,a.jsxs)("span",{className:"label",children:["sats",(0,a.jsx)("br",{}),"Max"]})]}),(0,a.jsxs)("div",{className:"zapUses",children:[(0,a.jsx)("span",{className:"zapUsesCurrent disabled",children:"0"}),(0,a.jsx)("span",{className:"label",children:"of"}),(0,a.jsx)("span",{className:"zapUsesTotal disabled",children:"5"})]})]}),(0,a.jsx)("div",{className:"noteCTA",children:(0,a.jsx)("button",{className:"noteMainCTA cta disabled",children:"Pay"})}),(0,a.jsxs)("div",{className:"noteActionsReactions",children:[(0,a.jsx)("div",{className:"noteZaps noteZapReactions"}),(0,a.jsxs)("div",{className:"noteActions",children:[(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"bolt"})}),(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"favorite"})}),(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"ios_share"})}),(0,a.jsx)("div",{className:"noteAction dropdown",children:(0,a.jsx)("button",{className:"dropbtn",children:(0,a.jsx)("span",{className:"material-symbols-outlined disabled",children:"more_horiz"})})})]})]})]})]}),!U&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"paynote blink",children:[(0,a.jsx)("div",{className:"noteProfileImg",children:(0,a.jsx)("img",{className:"userImg",src:"/images/generic-user-icon.svg",alt:"Profile"})}),(0,a.jsxs)("div",{className:"noteData",children:[(0,a.jsxs)("div",{className:"noteHeader",children:[(0,a.jsxs)("div",{className:"noteAuthor",children:[(0,a.jsx)("div",{className:"noteDisplayName",children:(0,a.jsx)("a",{href:"#",className:"noteAuthorLink disabled",target:"_blank",children:"Loading..."})}),(0,a.jsx)("div",{className:"noteNIP05 label",children:(0,a.jsxs)("a",{href:"#",target:"_blank",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"check_circle"}),"loading@example.com"]})}),(0,a.jsx)("div",{className:"noteLNAddress label",children:(0,a.jsxs)("a",{href:"#",target:"_blank",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"bolt"}),"loading@example.com"]})})]}),(0,a.jsx)("div",{className:"noteDate label",children:"Loading..."})]}),(0,a.jsx)("div",{className:"noteContent disabled",children:"Loading posts..."}),(0,a.jsxs)("div",{className:"noteValues",children:[(0,a.jsxs)("div",{className:"zapMin",children:[(0,a.jsx)("span",{className:"zapMinVal disabled",children:"Loading..."}),(0,a.jsxs)("span",{className:"label",children:["sats",(0,a.jsx)("br",{}),"Min"]})]}),(0,a.jsxs)("div",{className:"zapMax",children:[(0,a.jsx)("span",{className:"zapMaxVal disabled",children:"Loading..."}),(0,a.jsxs)("span",{className:"label",children:["sats",(0,a.jsx)("br",{}),"Max"]})]}),(0,a.jsxs)("div",{className:"zapUses",children:[(0,a.jsx)("span",{className:"zapUsesCurrent disabled",children:"0"}),(0,a.jsx)("span",{className:"label",children:"of"}),(0,a.jsx)("span",{className:"zapUsesTotal disabled",children:"5"})]})]}),(0,a.jsx)("div",{className:"noteCTA",children:(0,a.jsx)("button",{className:"noteMainCTA cta disabled",children:"Pay"})}),(0,a.jsxs)("div",{className:"noteActionsReactions",children:[(0,a.jsx)("div",{className:"noteZaps noteZapReactions"}),(0,a.jsxs)("div",{className:"noteActions",children:[(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"bolt"})}),(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"favorite"})}),(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"ios_share"})}),(0,a.jsx)("div",{className:"noteAction dropdown",children:(0,a.jsx)("button",{className:"dropbtn",children:(0,a.jsx)("span",{className:"material-symbols-outlined disabled",children:"more_horiz"})})})]})]})]})]}),(0,a.jsxs)("div",{className:"paynote blink",children:[(0,a.jsx)("div",{className:"noteProfileImg",children:(0,a.jsx)("img",{className:"userImg",src:"/images/generic-user-icon.svg",alt:"Profile"})}),(0,a.jsxs)("div",{className:"noteData",children:[(0,a.jsxs)("div",{className:"noteHeader",children:[(0,a.jsxs)("div",{className:"noteAuthor",children:[(0,a.jsx)("div",{className:"noteDisplayName",children:(0,a.jsx)("a",{href:"#",className:"noteAuthorLink disabled",target:"_blank",children:"Loading..."})}),(0,a.jsx)("div",{className:"noteNIP05 label",children:(0,a.jsxs)("a",{href:"#",target:"_blank",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"check_circle"}),"loading@example.com"]})}),(0,a.jsx)("div",{className:"noteLNAddress label",children:(0,a.jsxs)("a",{href:"#",target:"_blank",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"bolt"}),"loading@example.com"]})})]}),(0,a.jsx)("div",{className:"noteDate label",children:"Loading..."})]}),(0,a.jsx)("div",{className:"noteContent disabled",children:"Loading posts..."}),(0,a.jsxs)("div",{className:"noteValues",children:[(0,a.jsxs)("div",{className:"zapMin",children:[(0,a.jsx)("span",{className:"zapMinVal disabled",children:"Loading..."}),(0,a.jsxs)("span",{className:"label",children:["sats",(0,a.jsx)("br",{}),"Min"]})]}),(0,a.jsxs)("div",{className:"zapMax",children:[(0,a.jsx)("span",{className:"zapMaxVal disabled",children:"Loading..."}),(0,a.jsxs)("span",{className:"label",children:["sats",(0,a.jsx)("br",{}),"Max"]})]}),(0,a.jsxs)("div",{className:"zapUses",children:[(0,a.jsx)("span",{className:"zapUsesCurrent disabled",children:"0"}),(0,a.jsx)("span",{className:"label",children:"of"}),(0,a.jsx)("span",{className:"zapUsesTotal disabled",children:"5"})]})]}),(0,a.jsx)("div",{className:"noteCTA",children:(0,a.jsx)("button",{className:"noteMainCTA cta disabled",children:"Pay"})}),(0,a.jsxs)("div",{className:"noteActionsReactions",children:[(0,a.jsx)("div",{className:"noteZaps noteZapReactions"}),(0,a.jsxs)("div",{className:"noteActions",children:[(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"bolt"})}),(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"favorite"})}),(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"ios_share"})}),(0,a.jsx)("div",{className:"noteAction dropdown",children:(0,a.jsx)("button",{className:"dropbtn",children:(0,a.jsx)("span",{className:"material-symbols-outlined disabled",children:"more_horiz"})})})]})]})]})]})]})]}):0===V.length?(0,a.jsx)("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No posts found"}):V.map(e=>(0,a.jsx)(A,{post:e,onPay:ae,onPayAnonymously:te,onShare:me,onViewRaw:ue,isLoggedIn:$.isLoggedIn},e.id)),G&&(0,a.jsx)("div",{style:{textAlign:"center",padding:"20px",color:"#666"},children:"Loading more posts..."}),!U&&V.length>0&&(0,a.jsxs)("div",{style:{textAlign:"center",padding:"10px",fontSize:"12px",color:"#999",borderTop:"1px solid #eee",marginTop:"20px"},children:["Posts loaded: ",V.length," | Scroll to load more (100px from bottom)"]}),U&&H.map(e=>(0,a.jsx)(A,{post:e,onPay:ae,onPayAnonymously:te,onShare:me,onViewRaw:ue,isLoggedIn:$.isLoggedIn,isReply:!0},e.id))]}),(0,a.jsx)("div",{id:"following",style:{display:"following"===W?"block":"none"},children:K&&0===B.length?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"paynote blink",children:[(0,a.jsx)("div",{className:"noteProfileImg",children:(0,a.jsx)("img",{className:"userImg",src:"/images/generic-user-icon.svg",alt:"Profile"})}),(0,a.jsxs)("div",{className:"noteData",children:[(0,a.jsxs)("div",{className:"noteHeader",children:[(0,a.jsxs)("div",{className:"noteAuthor",children:[(0,a.jsx)("div",{className:"noteDisplayName",children:(0,a.jsx)("a",{href:"#",className:"noteAuthorLink disabled",target:"_blank",children:"Loading..."})}),(0,a.jsx)("div",{className:"noteNIP05 label",children:(0,a.jsxs)("a",{href:"#",target:"_blank",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"check_circle"}),"loading@example.com"]})}),(0,a.jsx)("div",{className:"noteLNAddress label",children:(0,a.jsxs)("a",{href:"#",target:"_blank",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"bolt"}),"loading@example.com"]})})]}),(0,a.jsx)("div",{className:"noteDate label",children:"Loading..."})]}),(0,a.jsx)("div",{className:"noteContent disabled",children:"Loading following posts..."}),(0,a.jsxs)("div",{className:"noteValues",children:[(0,a.jsxs)("div",{className:"zapMin",children:[(0,a.jsx)("span",{className:"zapMinVal disabled",children:"Loading..."}),(0,a.jsxs)("span",{className:"label",children:["sats",(0,a.jsx)("br",{}),"Min"]})]}),(0,a.jsxs)("div",{className:"zapMax",children:[(0,a.jsx)("span",{className:"zapMaxVal disabled",children:"Loading..."}),(0,a.jsxs)("span",{className:"label",children:["sats",(0,a.jsx)("br",{}),"Max"]})]}),(0,a.jsxs)("div",{className:"zapUses",children:[(0,a.jsx)("span",{className:"zapUsesCurrent disabled",children:"0"}),(0,a.jsx)("span",{className:"label",children:"of"}),(0,a.jsx)("span",{className:"zapUsesTotal disabled",children:"5"})]})]}),(0,a.jsx)("div",{className:"noteCTA",children:(0,a.jsx)("button",{className:"noteMainCTA cta disabled",children:"Pay"})}),(0,a.jsxs)("div",{className:"noteActionsReactions",children:[(0,a.jsx)("div",{className:"noteZaps noteZapReactions"}),(0,a.jsxs)("div",{className:"noteActions",children:[(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"bolt"})}),(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"favorite"})}),(0,a.jsx)("a",{className:"noteAction disabled",children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"ios_share"})}),(0,a.jsx)("div",{className:"noteAction dropdown",children:(0,a.jsx)("button",{className:"dropbtn",children:(0,a.jsx)("span",{className:"material-symbols-outlined disabled",children:"more_horiz"})})})]})]})]})]})}):0===B.length?(0,a.jsx)("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No following posts found"}):B.map(e=>(0,a.jsx)(A,{post:e,onPay:ae,onPayAnonymously:te,onShare:me,onViewRaw:ue,isLoggedIn:$.isLoggedIn},e.id))})]}),(0,a.jsx)("div",{className:"overlayContainer",id:"qrScanner",style:{display:e?"flex":"none"},children:(0,a.jsxs)("div",{className:"overlayInner",children:[(0,a.jsxs)("div",{className:"brand",children:["PUB",(0,a.jsx)("span",{style:{color:"#cecece"},children:"PAY"}),(0,a.jsx)("span",{style:{color:"#00000014"},children:".me"})]}),(0,a.jsx)("p",{className:"label",id:"titleScanner",children:"Scan note1 or nevent1 QR code"}),(0,a.jsx)("div",{id:"reader"}),(0,a.jsx)("a",{id:"stopScanner",href:"#",className:"label",onClick:()=>{P?P.getState().then(e=>{if("ACTIVE"===e||"PAUSED"===e)return P.stop()}).then(()=>{s(!1)}).catch(e=>{console.error("Error stopping QR scanner:",e),s(!1)}):s(!1)},children:"cancel"})]})}),(0,a.jsx)("div",{className:"overlayContainer",id:"loginForm",style:{display:n?"flex":"none"},children:(0,a.jsxs)("div",{className:"overlayInner",children:[(0,a.jsxs)("div",{className:"brand",children:["PUB",(0,a.jsx)("span",{style:{color:"#cecece"},children:"PAY"}),(0,a.jsx)("span",{style:{color:"#00000014"},children:".me"})]}),(0,a.jsx)("p",{className:"label",id:"titleSignin",children:"Choose Sign-in Method"}),(0,a.jsxs)("div",{className:"formFieldGroup",id:"loginFormGroup",children:[(0,a.jsx)("a",{href:"#",id:"signInExtension",className:"cta "+(E?"":"disabled red"),onClick:async e=>{if(E)try{const e=await Q(C);e&&e.success?d():D(!1)}catch(e){console.error("Extension sign in failed:",e),D(!1)}else e.preventDefault()},children:E?"Extension":"Not found"}),(0,a.jsx)("a",{href:"#",id:"signInexternalSigner",className:"cta "+(k?"":"disabled red"),onClick:async e=>{if(k&&!L)try{O(!0);const e=await X(C);e&&e.success?d():(T(!1),O(!1))}catch(e){console.error("External signer failed:",e),T(!1),O(!1)}else e.preventDefault()},children:k?L?"Loading...":"Signer":"Not found"}),(0,a.jsx)("a",{href:"#",id:"signInNsec",className:"cta",onClick:()=>{N(!0)},children:"NSEC"})]}),(0,a.jsx)("div",{id:"nsecInputGroup",style:{display:x?"block":"none"},children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),w.trim()&&(se(w,C),S(""),d())},children:[(0,a.jsx)("input",{type:"password",id:"nsecInput",placeholder:"Enter your nsec",className:"inputField",value:w,onChange:e=>S(e.target.value),required:!0}),(0,a.jsx)("button",{id:"continueWithNsec",className:"cta",type:"submit",onClick:async()=>{await se(w,C),d()},children:"Continue"})]})}),(0,a.jsxs)("div",{className:"rememberPK",children:[(0,a.jsx)("label",{htmlFor:"rememberMe",className:"label",children:"Remember"}),(0,a.jsx)("input",{type:"checkbox",className:"checkBoxRemember",id:"rememberMe",checked:C,onChange:e=>j(e.target.checked)})]}),(0,a.jsx)("a",{id:"cancelLogin",href:"#",className:"label",onClick:()=>{pe(),d()},children:"cancel"})]})}),(0,a.jsx)("div",{className:"overlayContainer",id:"loggedInForm",style:{display:o?"flex":"none"},children:(0,a.jsxs)("div",{className:"overlayInner",children:[(0,a.jsxs)("div",{className:"brand",children:["PUB",(0,a.jsx)("span",{style:{color:"#cecece"},children:"PAY"}),(0,a.jsx)("span",{style:{color:"#00000014"},children:".me"})]}),(0,a.jsx)("p",{className:"label",children:"You are logged in as:"}),(0,a.jsx)("p",{id:"loggedInPublicKey",children:$.publicKey?(0,a.jsx)("a",{href:`https://next.nostrudel.ninja/#/u/${"undefined"!=typeof window&&window.NostrTools?window.NostrTools.nip19.npubEncode($.publicKey):$.publicKey}`,className:"userMention",target:"_blank",rel:"noopener noreferrer",children:$.displayName||("undefined"!=typeof window&&window.NostrTools?window.NostrTools.nip19.npubEncode($.publicKey):$.publicKey)}):"Unknown"}),(0,a.jsx)("p",{className:"label",children:"Sign-in Method:"}),(0,a.jsx)("span",{id:"loggedInMethod",children:$.signInMethod||"Unknown"}),(0,a.jsx)("a",{href:"",id:"logoutButton",className:"cta",onClick:ne,children:"Logout"}),(0,a.jsx)("a",{id:"cancelLoggedin",href:"#",className:"label",onClick:()=>r(!1),children:"cancel"})]})}),(0,a.jsx)("div",{className:"overlayContainer",id:"invoiceOverlay",style:{display:i?"flex":"none"},children:(0,a.jsxs)("div",{className:"overlayInner",children:[(0,a.jsxs)("div",{className:"brand",children:["PUB",(0,a.jsx)("span",{style:{color:"#cecece"},children:"PAY"}),(0,a.jsx)("span",{style:{color:"#00000014"},children:".me"})]}),(0,a.jsx)("p",{id:"qrcodeTitle",className:"label",children:"Scan Invoice to Pay Zap"}),p.useUIStore.getState().invoiceOverlay.amount>0&&(0,a.jsxs)("p",{className:"label",style:{fontSize:"18px",fontWeight:"bold",color:"#4a75ff"},children:[p.useUIStore.getState().invoiceOverlay.amount.toLocaleString()," sats"]}),(0,a.jsx)(R,{bolt11:p.useUIStore.getState().invoiceOverlay.bolt11}),(0,a.jsx)("p",{id:"qrcodeTitle",className:"label",children:"Otherwise:"}),(0,a.jsxs)("div",{className:"formFieldGroup",children:[(0,a.jsx)("button",{id:"payWithExtension",className:"cta",onClick:()=>{const{bolt11:e,amount:s}=p.useUIStore.getState().invoiceOverlay;e&&s>0?(console.log("Paying with extension:",e),alert("Extension payment not yet implemented. Please scan the QR code with your Lightning wallet.")):alert("No invoice available to pay")},children:"Pay with Extension"}),(0,a.jsx)("button",{id:"payWithWallet",className:"cta",onClick:()=>{const e=p.useUIStore.getState().invoiceOverlay.bolt11;if(e)try{window.location.href=`lightning:${e}`}catch(e){console.error("Error opening wallet:",e)}else console.error("No invoice available to pay")},children:"Pay with Wallet"}),(0,a.jsx)("button",{id:"copyInvoice",className:"cta",onClick:async()=>{const e=p.useUIStore.getState().invoiceOverlay.bolt11;if(e)try{await navigator.clipboard.writeText(e);const s=document.getElementById("copyInvoice");s&&(s.textContent="Copied!",setTimeout(()=>{s.textContent="Copy Invoice"},1e3))}catch(s){console.error("Failed to copy invoice:",s);const n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n);const a=document.getElementById("copyInvoice");a&&(a.textContent="Copied!",setTimeout(()=>{a.textContent="Copy Invoice"},1e3))}else console.error("No invoice available to copy")},children:"Copy Invoice"})]}),(0,a.jsx)("a",{id:"closeInvoiceOverlay",href:"#",className:"label",onClick:()=>l(),children:"Close"})]})}),(0,a.jsx)("div",{className:"overlayContainer",id:"viewJSON",style:{display:m?"flex":"none"},children:(0,a.jsxs)("div",{className:"overlayInner",children:[(0,a.jsx)("pre",{id:"noteJSON",children:h}),(0,a.jsx)("a",{id:"closeJSON",href:"#",className:"label",onClick:()=>u(!1),children:"close"})]})}),(0,a.jsx)("div",{className:"overlayContainer",id:"newPayNoteForm",style:{display:y?"flex":"none"},children:(0,a.jsxs)("div",{className:"overlayInner",children:[(0,a.jsxs)("div",{className:"brand",children:["PUB",(0,a.jsx)("span",{style:{color:"#cecece"},children:"PAY"}),(0,a.jsx)("span",{style:{color:"#00000014"},children:".me"})]}),(0,a.jsxs)("form",{id:"newKind1",onSubmit:async e=>{e.preventDefault();const s=new FormData(e.target),n={};for(const[e,a]of s.entries())n[e]=a.toString();ge(!0);try{await ie(n),f(!1),v("fixed")}catch(e){console.error("Failed to post note:",e)}finally{ge(!1)}},children:[(0,a.jsxs)("div",{className:"formField",children:[(0,a.jsx)("label",{htmlFor:"payNoteContent",className:"label",children:"Your Payment Request"}),(0,a.jsx)("textarea",{id:"payNoteContent",name:"payNoteContent",rows:4,placeholder:"Payment Request Description"})]}),(0,a.jsxs)("fieldset",{className:"formField formSelector",children:[(0,a.jsx)("legend",{className:"uppercase",children:"Select type"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"radio",id:"fixedFlow",name:"paymentType",value:"fixed",checked:"fixed"===b,onChange:e=>{e.target.checked&&v("fixed")}}),(0,a.jsx)("label",{htmlFor:"fixedFlow",children:"Fixed"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"radio",id:"rangeFlow",name:"paymentType",value:"range",checked:"range"===b,onChange:e=>{e.target.checked&&v("range")}}),(0,a.jsx)("label",{htmlFor:"rangeFlow",children:"Range"})]}),(0,a.jsxs)("div",{className:"disabled",children:[(0,a.jsx)("input",{type:"radio",id:"targetFlow",name:"paymentType",value:"target",disabled:!0}),(0,a.jsx)("label",{htmlFor:"targetFlow",children:"Target"})]})]}),(0,a.jsx)("div",{className:"formFieldGroup",id:"fixedInterface",style:{display:"fixed"===b?"block":"none"},children:(0,a.jsxs)("div",{className:"formField",children:[(0,a.jsxs)("label",{htmlFor:"zapFixed",className:"label",children:["Fixed Amount* ",(0,a.jsx)("span",{className:"tagName",children:"zap-min = zap-max"})]}),(0,a.jsx)("input",{type:"number",min:1,id:"zapFixed",placeholder:"1",name:"zapFixed",required:"fixed"===b})]})}),(0,a.jsxs)("div",{className:"formFieldGroup",id:"rangeInterface",style:{display:"range"===b?"flex":"none"},children:[(0,a.jsxs)("div",{className:"formField",children:[(0,a.jsxs)("label",{htmlFor:"zapMin",className:"label",children:["Minimum* ",(0,a.jsx)("span",{className:"tagName",children:"zap-min"})]}),(0,a.jsx)("input",{type:"number",min:1,id:"zapMin",placeholder:"1",name:"zapMin",required:"range"===b})]}),(0,a.jsxs)("div",{className:"formField",children:[(0,a.jsxs)("label",{htmlFor:"zapMax",className:"label",children:["Maximum* ",(0,a.jsx)("span",{className:"tagName",children:"zap-max"})]}),(0,a.jsx)("input",{type:"number",min:1,id:"zapMax",placeholder:"1000000000",name:"zapMax",required:"range"===b})]})]}),(0,a.jsxs)("details",{className:"formField",children:[(0,a.jsx)("summary",{className:"legend summaryOptions",children:"Advanced Options"}),(0,a.jsxs)("div",{className:"formFieldGroup",children:[(0,a.jsxs)("div",{className:"formField",children:[(0,a.jsxs)("label",{htmlFor:"zapUses",className:"label",children:["Uses ",(0,a.jsx)("span",{className:"tagName",children:"zap-uses"})]}),(0,a.jsx)("input",{type:"number",min:1,id:"zapUses",placeholder:"1",name:"zapUses"})]}),(0,a.jsxs)("div",{className:"formField disabled",children:[(0,a.jsxs)("label",{htmlFor:"zapIncrement",className:"label",children:["Increment ",(0,a.jsx)("span",{className:"tagName"})]}),(0,a.jsx)("input",{type:"text",id:"zapIncrement",placeholder:"0",name:"zapIncrement",disabled:!0})]})]}),(0,a.jsxs)("div",{className:"formField",children:[(0,a.jsxs)("label",{htmlFor:"zapPayer",className:"label",children:["Payer ",(0,a.jsx)("span",{className:"tagName",children:"zap-payer"})]}),(0,a.jsx)("input",{type:"text",id:"zapPayer",placeholder:"npub1...",name:"zapPayer"})]}),(0,a.jsxs)("div",{className:"formField",children:[(0,a.jsxs)("label",{htmlFor:"overrideLNURL",className:"label",children:["Override receiving address",(0,a.jsx)("span",{className:"tagName",children:" zap-lnurl"})]}),(0,a.jsx)("input",{type:"email",id:"overrideLNURL",placeholder:"address@lnprovider.net",name:"overrideLNURL"})]}),(0,a.jsxs)("div",{className:"formField disabled",children:[(0,a.jsxs)("label",{htmlFor:"redirectToNote",className:"label",children:["Redirect payment to note ",(0,a.jsx)("span",{className:"tagName",children:"zap-redirect"})," "]}),(0,a.jsx)("input",{type:"text",id:"redirectToNote",placeholder:"note1...",name:"redirectToNote",disabled:!0})]})]}),(0,a.jsx)("button",{type:"submit",id:"postNote",className:"cta",children:he?"Publishing...":"Publish"})]}),(0,a.jsx)("a",{id:"cancelNewNote",href:"#",className:"label",onClick:()=>f(!1),children:"cancel"})]})})]})},k=()=>(0,a.jsx)("div",{className:"overlayContainer",style:{display:"block"},children:(0,a.jsxs)("div",{className:"overlayInner",children:[(0,a.jsxs)("div",{className:"brand",children:["PUB",(0,a.jsx)("span",{style:{color:"#cecece"},children:"PAY"}),(0,a.jsx)("span",{style:{color:"#00000014"},children:".me"})]}),(0,a.jsx)("h2",{children:"404 - Page Not Found"}),(0,a.jsx)("p",{children:"The page you're looking for doesn't exist."}),(0,a.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,a.jsx)(r.N_,{to:"/",className:"cta",style:{marginRight:"1rem"},children:"Go Home"}),(0,a.jsx)(r.N_,{to:"/live",className:"cta",style:{marginRight:"1rem"},children:"Live Display"}),(0,a.jsx)(r.N_,{to:"/jukebox",className:"cta",children:"Jukebox"})]})]})}),T=document.getElementById("root");if(!T)throw new Error("Root element not found");const L=(0,o.createRoot)(T),O=d();L.render((0,a.jsx)(t.StrictMode,{children:(0,a.jsx)(i.Ht,{client:O,children:(0,a.jsx)(r.Kd,{children:(0,a.jsx)(()=>(0,a.jsxs)(r.BV,{children:[(0,a.jsx)(r.qh,{path:"/",element:(0,a.jsx)(D,{})}),(0,a.jsx)(r.qh,{path:"/404",element:(0,a.jsx)(k,{})}),(0,a.jsx)(r.qh,{path:"*",element:(0,a.jsx)(r.C5,{to:"/404",replace:!0})})]}),{})})})}))}},n={};function a(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return s[e](o,o.exports,a),o.exports}a.m=s,e=[],a.O=(s,n,t,o)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,t,o]=e[d],i=!0,l=0;l<n.length;l++)(!1&o||r>=o)&&Object.keys(a.O).every(e=>a.O[e](n[l]))?n.splice(l--,1):(i=!1,o<r&&(r=o));if(i){e.splice(d--,1);var c=t();void 0!==c&&(s=c)}}return s}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,t,o]},a.d=(e,s)=>{for(var n in s)a.o(s,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})},a.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};a.O.j=s=>0===e[s];var s=(s,n)=>{var t,o,[r,i,l]=n,c=0;if(r.some(s=>0!==e[s])){for(t in i)a.o(i,t)&&(a.m[t]=i[t]);if(l)var d=l(a)}for(s&&s(n);c<r.length;c++)o=r[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},n=self.webpackChunkpubpay=self.webpackChunkpubpay||[];n.forEach(s.bind(null,0)),n.push=s.bind(null,n.push.bind(n))})();var t=a.O(void 0,[96],()=>a(802));t=a.O(t)})();